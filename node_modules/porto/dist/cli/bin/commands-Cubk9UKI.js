import*as e from"node:fs";import*as t from"node:os";import*as n from"node:path";import{setTimeout as r}from"node:timers/promises";import{stripVTControlCharacters as i}from"node:util";import a,{stdin as o,stdout as s}from"node:process";import*as c from"node:readline";import l from"node:readline";import{Writable as u}from"node:stream";import{BaseError as d,createClient as f,createTransport as p,custom as m,defineChain as h,fallback as g,getAddress as _,hashMessage as v,hashTypedData as y,http as b,numberToHex as ee,withCache as x,zeroAddress as S}from"viem";import*as te from"viem/actions";import{getEip712Domain as ne,verifyHash as C,waitForCallsStatus as w}from"viem/actions";import{anvil as re,arbitrum as ie,arbitrumSepolia as ae,base as oe,baseSepolia as se,berachain as ce,berachainBepolia as le,bsc as ue,celo as de,gnosis as fe,hoodi as pe,katana as me,mainnet as he,optimism as ge,optimismSepolia as _e,polygon as ve,sepolia as ye}from"viem/chains";import*as be from"ox/AbiFunction";import*as xe from"ox/AbiParameters";import*as T from"ox/Address";import*as E from"ox/Bytes";import*as Se from"ox/Hash";import*as D from"ox/Hex";import*as Ce from"ox/Json";import*as we from"ox/P256";import*as O from"ox/PublicKey";import*as k from"ox/Secp256k1";import*as Te from"ox/Signature";import*as Ee from"ox/TypedData";import*as De from"ox/Value";import*as Oe from"ox/WebAuthnP256";import*as ke from"ox/WebCryptoP256";import*as A from"zod/mini";import{z as j}from"zod/mini";import*as Ae from"ox/Errors";import{toAccount as je}from"viem/accounts";import*as M from"ox/Provider";import*as Me from"node:url";import{Json as Ne}from"ox";import*as Pe from"node:http";import*as Fe from"ox/AbiItem";import*as Ie from"ox/RpcRequest";import*as Le from"ox/RpcResponse";import*as Re from"ox/RpcSchema";import*as ze from"ox/Siwe";import*as Be from"ox/PersonalMessage";import*as Ve from"ox/AbiError";import"ox/Authorization";import{getExecuteError as He}from"viem/experimental/erc7821";import*as Ue from"ox/erc8010/SignatureErc8010";import{devtools as We,persist as Ge,subscribeWithSelector as Ke}from"zustand/middleware";import{createStore as qe}from"zustand/vanilla";import*as Je from"mipd";import{createStore as Ye,del as Xe,get as Ze,set as Qe}from"idb-keyval";var $e=Object.create,et=Object.defineProperty,tt=Object.getOwnPropertyDescriptor,nt=Object.getOwnPropertyNames,rt=Object.getPrototypeOf,it=Object.prototype.hasOwnProperty,at=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),ot=e=>{let t={};for(var n in e)et(t,n,{get:e[n],enumerable:!0});return t},st=(e,t,n,r)=>{if(t&&typeof t==`object`||typeof t==`function`)for(var i=nt(t),a=0,o=i.length,s;a<o;a++)s=i[a],!it.call(e,s)&&s!==n&&et(e,s,{get:(e=>t[e]).bind(null,s),enumerable:!(r=tt(t,s))||r.enumerable});return e},ct=(e,t,n)=>(n=e==null?{}:$e(rt(e)),st(t||!e||!e.__esModule?et(n,`default`,{value:e,enumerable:!0}):n,e)),lt=at(((e,t)=>{let n={to(e,t){return t?`[${t+1};${e+1}H`:`[${e+1}G`},move(e,t){let n=``;return e<0?n+=`[${-e}D`:e>0&&(n+=`[${e}C`),t<0?n+=`[${-t}A`:t>0&&(n+=`[${t}B`),n},up:(e=1)=>`[${e}A`,down:(e=1)=>`[${e}B`,forward:(e=1)=>`[${e}C`,backward:(e=1)=>`[${e}D`,nextLine:(e=1)=>`\x1B[E`.repeat(e),prevLine:(e=1)=>`\x1B[F`.repeat(e),left:`\x1B[G`,hide:`\x1B[?25l`,show:`\x1B[?25h`,save:`\x1B7`,restore:`\x1B8`};t.exports={cursor:n,scroll:{up:(e=1)=>`\x1B[S`.repeat(e),down:(e=1)=>`\x1B[T`.repeat(e)},erase:{screen:`\x1B[2J`,up:(e=1)=>`\x1B[1J`.repeat(e),down:(e=1)=>`\x1B[J`.repeat(e),line:`\x1B[2K`,lineEnd:`\x1B[K`,lineStart:`\x1B[1K`,lines(e){let t=``;for(let r=0;r<e;r++)t+=this.line+(r<e-1?n.up():``);return e&&(t+=n.left),t}},beep:`\x07`}})),ut=at(((e,t)=>{let n=process||{},r=n.argv||[],i=n.env||{},a=!(i.NO_COLOR||r.includes(`--no-color`))&&(!!i.FORCE_COLOR||r.includes(`--color`)||n.platform===`win32`||(n.stdout||{}).isTTY&&i.TERM!==`dumb`||!!i.CI),o=(e,t,n=e)=>r=>{let i=``+r,a=i.indexOf(t,e.length);return~a?e+s(i,t,n,a)+t:e+i+t},s=(e,t,n,r)=>{let i=``,a=0;do i+=e.substring(a,r)+n,a=r+t.length,r=e.indexOf(t,a);while(~r);return i+e.substring(a)},c=(e=a)=>{let t=e?o:()=>String;return{isColorSupported:e,reset:t(`\x1B[0m`,`\x1B[0m`),bold:t(`\x1B[1m`,`\x1B[22m`,`\x1B[22m\x1B[1m`),dim:t(`\x1B[2m`,`\x1B[22m`,`\x1B[22m\x1B[2m`),italic:t(`\x1B[3m`,`\x1B[23m`),underline:t(`\x1B[4m`,`\x1B[24m`),inverse:t(`\x1B[7m`,`\x1B[27m`),hidden:t(`\x1B[8m`,`\x1B[28m`),strikethrough:t(`\x1B[9m`,`\x1B[29m`),black:t(`\x1B[30m`,`\x1B[39m`),red:t(`\x1B[31m`,`\x1B[39m`),green:t(`\x1B[32m`,`\x1B[39m`),yellow:t(`\x1B[33m`,`\x1B[39m`),blue:t(`\x1B[34m`,`\x1B[39m`),magenta:t(`\x1B[35m`,`\x1B[39m`),cyan:t(`\x1B[36m`,`\x1B[39m`),white:t(`\x1B[37m`,`\x1B[39m`),gray:t(`\x1B[90m`,`\x1B[39m`),bgBlack:t(`\x1B[40m`,`\x1B[49m`),bgRed:t(`\x1B[41m`,`\x1B[49m`),bgGreen:t(`\x1B[42m`,`\x1B[49m`),bgYellow:t(`\x1B[43m`,`\x1B[49m`),bgBlue:t(`\x1B[44m`,`\x1B[49m`),bgMagenta:t(`\x1B[45m`,`\x1B[49m`),bgCyan:t(`\x1B[46m`,`\x1B[49m`),bgWhite:t(`\x1B[47m`,`\x1B[49m`),blackBright:t(`\x1B[90m`,`\x1B[39m`),redBright:t(`\x1B[91m`,`\x1B[39m`),greenBright:t(`\x1B[92m`,`\x1B[39m`),yellowBright:t(`\x1B[93m`,`\x1B[39m`),blueBright:t(`\x1B[94m`,`\x1B[39m`),magentaBright:t(`\x1B[95m`,`\x1B[39m`),cyanBright:t(`\x1B[96m`,`\x1B[39m`),whiteBright:t(`\x1B[97m`,`\x1B[39m`),bgBlackBright:t(`\x1B[100m`,`\x1B[49m`),bgRedBright:t(`\x1B[101m`,`\x1B[49m`),bgGreenBright:t(`\x1B[102m`,`\x1B[49m`),bgYellowBright:t(`\x1B[103m`,`\x1B[49m`),bgBlueBright:t(`\x1B[104m`,`\x1B[49m`),bgMagentaBright:t(`\x1B[105m`,`\x1B[49m`),bgCyanBright:t(`\x1B[106m`,`\x1B[49m`),bgWhiteBright:t(`\x1B[107m`,`\x1B[49m`)}};t.exports=c(),t.exports.createColors=c})),N=ct(lt(),1);ut();function dt({onlyFirst:e=!1}={}){let t=[`[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?(?:\\u0007|\\u001B\\u005C|\\u009C))`,`(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-nq-uy=><~]))`].join(`|`);return new RegExp(t,e?void 0:`g`)}const ft=dt();function pt(e){if(typeof e!=`string`)throw TypeError(`Expected a \`string\`, got \`${typeof e}\``);return e.replace(ft,``)}function mt(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,`default`)?e.default:e}var ht={exports:{}};(function(e){var t={};e.exports=t,t.eastAsianWidth=function(e){var t=e.charCodeAt(0),n=e.length==2?e.charCodeAt(1):0,r=t;return 55296<=t&&t<=56319&&56320<=n&&n<=57343&&(t&=1023,n&=1023,r=t<<10|n,r+=65536),r==12288||65281<=r&&r<=65376||65504<=r&&r<=65510?`F`:r==8361||65377<=r&&r<=65470||65474<=r&&r<=65479||65482<=r&&r<=65487||65490<=r&&r<=65495||65498<=r&&r<=65500||65512<=r&&r<=65518?`H`:4352<=r&&r<=4447||4515<=r&&r<=4519||4602<=r&&r<=4607||9001<=r&&r<=9002||11904<=r&&r<=11929||11931<=r&&r<=12019||12032<=r&&r<=12245||12272<=r&&r<=12283||12289<=r&&r<=12350||12353<=r&&r<=12438||12441<=r&&r<=12543||12549<=r&&r<=12589||12593<=r&&r<=12686||12688<=r&&r<=12730||12736<=r&&r<=12771||12784<=r&&r<=12830||12832<=r&&r<=12871||12880<=r&&r<=13054||13056<=r&&r<=19903||19968<=r&&r<=42124||42128<=r&&r<=42182||43360<=r&&r<=43388||44032<=r&&r<=55203||55216<=r&&r<=55238||55243<=r&&r<=55291||63744<=r&&r<=64255||65040<=r&&r<=65049||65072<=r&&r<=65106||65108<=r&&r<=65126||65128<=r&&r<=65131||110592<=r&&r<=110593||127488<=r&&r<=127490||127504<=r&&r<=127546||127552<=r&&r<=127560||127568<=r&&r<=127569||131072<=r&&r<=194367||177984<=r&&r<=196605||196608<=r&&r<=262141?`W`:32<=r&&r<=126||162<=r&&r<=163||165<=r&&r<=166||r==172||r==175||10214<=r&&r<=10221||10629<=r&&r<=10630?`Na`:r==161||r==164||167<=r&&r<=168||r==170||173<=r&&r<=174||176<=r&&r<=180||182<=r&&r<=186||188<=r&&r<=191||r==198||r==208||215<=r&&r<=216||222<=r&&r<=225||r==230||232<=r&&r<=234||236<=r&&r<=237||r==240||242<=r&&r<=243||247<=r&&r<=250||r==252||r==254||r==257||r==273||r==275||r==283||294<=r&&r<=295||r==299||305<=r&&r<=307||r==312||319<=r&&r<=322||r==324||328<=r&&r<=331||r==333||338<=r&&r<=339||358<=r&&r<=359||r==363||r==462||r==464||r==466||r==468||r==470||r==472||r==474||r==476||r==593||r==609||r==708||r==711||713<=r&&r<=715||r==717||r==720||728<=r&&r<=731||r==733||r==735||768<=r&&r<=879||913<=r&&r<=929||931<=r&&r<=937||945<=r&&r<=961||963<=r&&r<=969||r==1025||1040<=r&&r<=1103||r==1105||r==8208||8211<=r&&r<=8214||8216<=r&&r<=8217||8220<=r&&r<=8221||8224<=r&&r<=8226||8228<=r&&r<=8231||r==8240||8242<=r&&r<=8243||r==8245||r==8251||r==8254||r==8308||r==8319||8321<=r&&r<=8324||r==8364||r==8451||r==8453||r==8457||r==8467||r==8470||8481<=r&&r<=8482||r==8486||r==8491||8531<=r&&r<=8532||8539<=r&&r<=8542||8544<=r&&r<=8555||8560<=r&&r<=8569||r==8585||8592<=r&&r<=8601||8632<=r&&r<=8633||r==8658||r==8660||r==8679||r==8704||8706<=r&&r<=8707||8711<=r&&r<=8712||r==8715||r==8719||r==8721||r==8725||r==8730||8733<=r&&r<=8736||r==8739||r==8741||8743<=r&&r<=8748||r==8750||8756<=r&&r<=8759||8764<=r&&r<=8765||r==8776||r==8780||r==8786||8800<=r&&r<=8801||8804<=r&&r<=8807||8810<=r&&r<=8811||8814<=r&&r<=8815||8834<=r&&r<=8835||8838<=r&&r<=8839||r==8853||r==8857||r==8869||r==8895||r==8978||9312<=r&&r<=9449||9451<=r&&r<=9547||9552<=r&&r<=9587||9600<=r&&r<=9615||9618<=r&&r<=9621||9632<=r&&r<=9633||9635<=r&&r<=9641||9650<=r&&r<=9651||9654<=r&&r<=9655||9660<=r&&r<=9661||9664<=r&&r<=9665||9670<=r&&r<=9672||r==9675||9678<=r&&r<=9681||9698<=r&&r<=9701||r==9711||9733<=r&&r<=9734||r==9737||9742<=r&&r<=9743||9748<=r&&r<=9749||r==9756||r==9758||r==9792||r==9794||9824<=r&&r<=9825||9827<=r&&r<=9829||9831<=r&&r<=9834||9836<=r&&r<=9837||r==9839||9886<=r&&r<=9887||9918<=r&&r<=9919||9924<=r&&r<=9933||9935<=r&&r<=9953||r==9955||9960<=r&&r<=9983||r==10045||r==10071||10102<=r&&r<=10111||11093<=r&&r<=11097||12872<=r&&r<=12879||57344<=r&&r<=63743||65024<=r&&r<=65039||r==65533||127232<=r&&r<=127242||127248<=r&&r<=127277||127280<=r&&r<=127337||127344<=r&&r<=127386||917760<=r&&r<=917999||983040<=r&&r<=1048573||1048576<=r&&r<=1114109?`A`:`N`},t.characterLength=function(e){var t=this.eastAsianWidth(e);return t==`F`||t==`W`||t==`A`?2:1};function n(e){return e.match(/[\uD800-\uDBFF][\uDC00-\uDFFF]|[^\uD800-\uDFFF]/g)||[]}t.length=function(e){for(var t=n(e),r=0,i=0;i<t.length;i++)r+=this.characterLength(t[i]);return r},t.slice=function(e,r,i){textLen=t.length(e),r||=0,i||=1,r<0&&(r=textLen+r),i<0&&(i=textLen+i);for(var a=``,o=0,s=n(e),c=0;c<s.length;c++){var l=s[c],u=t.length(l);if(o>=r-(u==2?1:0))if(o+u<=i)a+=l;else break;o+=u}return a}})(ht);var gt=ht.exports;const _t=mt(gt),vt=mt(function(){return/\uD83C\uDFF4\uDB40\uDC67\uDB40\uDC62(?:\uDB40\uDC77\uDB40\uDC6C\uDB40\uDC73|\uDB40\uDC73\uDB40\uDC63\uDB40\uDC74|\uDB40\uDC65\uDB40\uDC6E\uDB40\uDC67)\uDB40\uDC7F|(?:\uD83E\uDDD1\uD83C\uDFFF\u200D\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1|\uD83D\uDC69\uD83C\uDFFF\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69]))(?:\uD83C[\uDFFB-\uDFFE])|(?:\uD83E\uDDD1\uD83C\uDFFE\u200D\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1|\uD83D\uDC69\uD83C\uDFFE\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69]))(?:\uD83C[\uDFFB-\uDFFD\uDFFF])|(?:\uD83E\uDDD1\uD83C\uDFFD\u200D\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1|\uD83D\uDC69\uD83C\uDFFD\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69]))(?:\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])|(?:\uD83E\uDDD1\uD83C\uDFFC\u200D\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1|\uD83D\uDC69\uD83C\uDFFC\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69]))(?:\uD83C[\uDFFB\uDFFD-\uDFFF])|(?:\uD83E\uDDD1\uD83C\uDFFB\u200D\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1|\uD83D\uDC69\uD83C\uDFFB\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69]))(?:\uD83C[\uDFFC-\uDFFF])|\uD83D\uDC68(?:\uD83C\uDFFB(?:\u200D(?:\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFF]))|\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFC-\uDFFF])|[\u2695\u2696\u2708]\uFE0F|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD]))?|(?:\uD83C[\uDFFC-\uDFFF])\u200D\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFF]))|\u200D(?:\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D)?\uD83D\uDC68|(?:\uD83D[\uDC68\uDC69])\u200D(?:\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67]))|\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67])|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFF\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFE])|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFE\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFD\uDFFF])|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFD\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFC\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB\uDFFD-\uDFFF])|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|(?:\uD83C\uDFFF\u200D[\u2695\u2696\u2708]|\uD83C\uDFFE\u200D[\u2695\u2696\u2708]|\uD83C\uDFFD\u200D[\u2695\u2696\u2708]|\uD83C\uDFFC\u200D[\u2695\u2696\u2708]|\u200D[\u2695\u2696\u2708])\uFE0F|\u200D(?:(?:\uD83D[\uDC68\uDC69])\u200D(?:\uD83D[\uDC66\uDC67])|\uD83D[\uDC66\uDC67])|\uD83C\uDFFF|\uD83C\uDFFE|\uD83C\uDFFD|\uD83C\uDFFC)?|(?:\uD83D\uDC69(?:\uD83C\uDFFB\u200D\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D(?:\uD83D[\uDC68\uDC69])|\uD83D[\uDC68\uDC69])|(?:\uD83C[\uDFFC-\uDFFF])\u200D\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D(?:\uD83D[\uDC68\uDC69])|\uD83D[\uDC68\uDC69]))|\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFF])\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1)(?:\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC69\u200D\uD83D\uDC69\u200D(?:\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67]))|\uD83D\uDC69(?:\u200D(?:\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D(?:\uD83D[\uDC68\uDC69])|\uD83D[\uDC68\uDC69])|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFF\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFE\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFD\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFC\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFB\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD]))|\uD83E\uDDD1(?:\u200D(?:\uD83E\uDD1D\u200D\uD83E\uDDD1|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFF\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFE\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFD\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFC\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFB\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD]))|\uD83D\uDC69\u200D\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC69\u200D\uD83D\uDC69\u200D(?:\uD83D[\uDC66\uDC67])|\uD83D\uDC69\u200D\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67])|(?:\uD83D\uDC41\uFE0F\u200D\uD83D\uDDE8|\uD83E\uDDD1(?:\uD83C\uDFFF\u200D[\u2695\u2696\u2708]|\uD83C\uDFFE\u200D[\u2695\u2696\u2708]|\uD83C\uDFFD\u200D[\u2695\u2696\u2708]|\uD83C\uDFFC\u200D[\u2695\u2696\u2708]|\uD83C\uDFFB\u200D[\u2695\u2696\u2708]|\u200D[\u2695\u2696\u2708])|\uD83D\uDC69(?:\uD83C\uDFFF\u200D[\u2695\u2696\u2708]|\uD83C\uDFFE\u200D[\u2695\u2696\u2708]|\uD83C\uDFFD\u200D[\u2695\u2696\u2708]|\uD83C\uDFFC\u200D[\u2695\u2696\u2708]|\uD83C\uDFFB\u200D[\u2695\u2696\u2708]|\u200D[\u2695\u2696\u2708])|\uD83D\uDE36\u200D\uD83C\uDF2B|\uD83C\uDFF3\uFE0F\u200D\u26A7|\uD83D\uDC3B\u200D\u2744|(?:(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC70\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD35\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD4\uDDD6-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC6F|\uD83E[\uDD3C\uDDDE\uDDDF])\u200D[\u2640\u2642]|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]|\uD83C\uDFF4\u200D\u2620|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC70\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD35\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD4\uDDD6-\uDDDD])\u200D[\u2640\u2642]|[\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u2328\u23CF\u23ED-\u23EF\u23F1\u23F2\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB\u25FC\u2600-\u2604\u260E\u2611\u2618\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u2692\u2694-\u2697\u2699\u269B\u269C\u26A0\u26A7\u26B0\u26B1\u26C8\u26CF\u26D1\u26D3\u26E9\u26F0\u26F1\u26F4\u26F7\u26F8\u2702\u2708\u2709\u270F\u2712\u2714\u2716\u271D\u2721\u2733\u2734\u2744\u2747\u2763\u27A1\u2934\u2935\u2B05-\u2B07\u3030\u303D\u3297\u3299]|\uD83C[\uDD70\uDD71\uDD7E\uDD7F\uDE02\uDE37\uDF21\uDF24-\uDF2C\uDF36\uDF7D\uDF96\uDF97\uDF99-\uDF9B\uDF9E\uDF9F\uDFCD\uDFCE\uDFD4-\uDFDF\uDFF5\uDFF7]|\uD83D[\uDC3F\uDCFD\uDD49\uDD4A\uDD6F\uDD70\uDD73\uDD76-\uDD79\uDD87\uDD8A-\uDD8D\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA\uDECB\uDECD-\uDECF\uDEE0-\uDEE5\uDEE9\uDEF0\uDEF3])\uFE0F|\uD83C\uDFF3\uFE0F\u200D\uD83C\uDF08|\uD83D\uDC69\u200D\uD83D\uDC67|\uD83D\uDC69\u200D\uD83D\uDC66|\uD83D\uDE35\u200D\uD83D\uDCAB|\uD83D\uDE2E\u200D\uD83D\uDCA8|\uD83D\uDC15\u200D\uD83E\uDDBA|\uD83E\uDDD1(?:\uD83C\uDFFF|\uD83C\uDFFE|\uD83C\uDFFD|\uD83C\uDFFC|\uD83C\uDFFB)?|\uD83D\uDC69(?:\uD83C\uDFFF|\uD83C\uDFFE|\uD83C\uDFFD|\uD83C\uDFFC|\uD83C\uDFFB)?|\uD83C\uDDFD\uD83C\uDDF0|\uD83C\uDDF6\uD83C\uDDE6|\uD83C\uDDF4\uD83C\uDDF2|\uD83D\uDC08\u200D\u2B1B|\u2764\uFE0F\u200D(?:\uD83D\uDD25|\uD83E\uDE79)|\uD83D\uDC41\uFE0F|\uD83C\uDFF3\uFE0F|\uD83C\uDDFF(?:\uD83C[\uDDE6\uDDF2\uDDFC])|\uD83C\uDDFE(?:\uD83C[\uDDEA\uDDF9])|\uD83C\uDDFC(?:\uD83C[\uDDEB\uDDF8])|\uD83C\uDDFB(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA])|\uD83C\uDDFA(?:\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF])|\uD83C\uDDF9(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF])|\uD83C\uDDF8(?:\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF])|\uD83C\uDDF7(?:\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC])|\uD83C\uDDF5(?:\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE])|\uD83C\uDDF3(?:\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF])|\uD83C\uDDF2(?:\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF])|\uD83C\uDDF1(?:\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE])|\uD83C\uDDF0(?:\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF])|\uD83C\uDDEF(?:\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5])|\uD83C\uDDEE(?:\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9])|\uD83C\uDDED(?:\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA])|\uD83C\uDDEC(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE])|\uD83C\uDDEB(?:\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7])|\uD83C\uDDEA(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA])|\uD83C\uDDE9(?:\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF])|\uD83C\uDDE8(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF])|\uD83C\uDDE7(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF])|\uD83C\uDDE6(?:\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF])|[#\*0-9]\uFE0F\u20E3|\u2764\uFE0F|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC70\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD35\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD4\uDDD6-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])|\uD83C\uDFF4|(?:[\u270A\u270B]|\uD83C[\uDF85\uDFC2\uDFC7]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC6B-\uDC6D\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDC8F\uDC91\uDCAA\uDD7A\uDD95\uDD96\uDE4C\uDE4F\uDEC0\uDECC]|\uD83E[\uDD0C\uDD0F\uDD18-\uDD1C\uDD1E\uDD1F\uDD30-\uDD34\uDD36\uDD77\uDDB5\uDDB6\uDDBB\uDDD2\uDDD3\uDDD5])(?:\uD83C[\uDFFB-\uDFFF])|(?:[\u261D\u270C\u270D]|\uD83D[\uDD74\uDD90])(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])|[\u270A\u270B]|\uD83C[\uDF85\uDFC2\uDFC7]|\uD83D[\uDC08\uDC15\uDC3B\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC6B-\uDC6D\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDC8F\uDC91\uDCAA\uDD7A\uDD95\uDD96\uDE2E\uDE35\uDE36\uDE4C\uDE4F\uDEC0\uDECC]|\uD83E[\uDD0C\uDD0F\uDD18-\uDD1C\uDD1E\uDD1F\uDD30-\uDD34\uDD36\uDD77\uDDB5\uDDB6\uDDBB\uDDD2\uDDD3\uDDD5]|\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC70\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD35\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD4\uDDD6-\uDDDD]|\uD83D\uDC6F|\uD83E[\uDD3C\uDDDE\uDDDF]|[\u231A\u231B\u23E9-\u23EC\u23F0\u23F3\u25FD\u25FE\u2614\u2615\u2648-\u2653\u267F\u2693\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26CE\u26D4\u26EA\u26F2\u26F3\u26F5\u26FA\u26FD\u2705\u2728\u274C\u274E\u2753-\u2755\u2757\u2795-\u2797\u27B0\u27BF\u2B1B\u2B1C\u2B50\u2B55]|\uD83C[\uDC04\uDCCF\uDD8E\uDD91-\uDD9A\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF84\uDF86-\uDF93\uDFA0-\uDFC1\uDFC5\uDFC6\uDFC8\uDFC9\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF8-\uDFFF]|\uD83D[\uDC00-\uDC07\uDC09-\uDC14\uDC16-\uDC3A\uDC3C-\uDC3E\uDC40\uDC44\uDC45\uDC51-\uDC65\uDC6A\uDC79-\uDC7B\uDC7D-\uDC80\uDC84\uDC88-\uDC8E\uDC90\uDC92-\uDCA9\uDCAB-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDDA4\uDDFB-\uDE2D\uDE2F-\uDE34\uDE37-\uDE44\uDE48-\uDE4A\uDE80-\uDEA2\uDEA4-\uDEB3\uDEB7-\uDEBF\uDEC1-\uDEC5\uDED0-\uDED2\uDED5-\uDED7\uDEEB\uDEEC\uDEF4-\uDEFC\uDFE0-\uDFEB]|\uD83E[\uDD0D\uDD0E\uDD10-\uDD17\uDD1D\uDD20-\uDD25\uDD27-\uDD2F\uDD3A\uDD3F-\uDD45\uDD47-\uDD76\uDD78\uDD7A-\uDDB4\uDDB7\uDDBA\uDDBC-\uDDCB\uDDD0\uDDE0-\uDDFF\uDE70-\uDE74\uDE78-\uDE7A\uDE80-\uDE86\uDE90-\uDEA8\uDEB0-\uDEB6\uDEC0-\uDEC2\uDED0-\uDED6]|(?:[\u231A\u231B\u23E9-\u23EC\u23F0\u23F3\u25FD\u25FE\u2614\u2615\u2648-\u2653\u267F\u2693\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26CE\u26D4\u26EA\u26F2\u26F3\u26F5\u26FA\u26FD\u2705\u270A\u270B\u2728\u274C\u274E\u2753-\u2755\u2757\u2795-\u2797\u27B0\u27BF\u2B1B\u2B1C\u2B50\u2B55]|\uD83C[\uDC04\uDCCF\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF93\uDFA0-\uDFCA\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF4\uDFF8-\uDFFF]|\uD83D[\uDC00-\uDC3E\uDC40\uDC42-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDD7A\uDD95\uDD96\uDDA4\uDDFB-\uDE4F\uDE80-\uDEC5\uDECC\uDED0-\uDED2\uDED5-\uDED7\uDEEB\uDEEC\uDEF4-\uDEFC\uDFE0-\uDFEB]|\uD83E[\uDD0C-\uDD3A\uDD3C-\uDD45\uDD47-\uDD78\uDD7A-\uDDCB\uDDCD-\uDDFF\uDE70-\uDE74\uDE78-\uDE7A\uDE80-\uDE86\uDE90-\uDEA8\uDEB0-\uDEB6\uDEC0-\uDEC2\uDED0-\uDED6])|(?:[#\*0-9\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u261D\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26A7\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CE\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2702\u2705\u2708-\u270D\u270F\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763\u2764\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDED5-\uDED7\uDEE0-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEFC\uDFE0-\uDFEB]|\uD83E[\uDD0C-\uDD3A\uDD3C-\uDD45\uDD47-\uDD78\uDD7A-\uDDCB\uDDCD-\uDDFF\uDE70-\uDE74\uDE78-\uDE7A\uDE80-\uDE86\uDE90-\uDEA8\uDEB0-\uDEB6\uDEC0-\uDEC2\uDED0-\uDED6])\uFE0F|(?:[\u261D\u26F9\u270A-\u270D]|\uD83C[\uDF85\uDFC2-\uDFC4\uDFC7\uDFCA-\uDFCC]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66-\uDC78\uDC7C\uDC81-\uDC83\uDC85-\uDC87\uDC8F\uDC91\uDCAA\uDD74\uDD75\uDD7A\uDD90\uDD95\uDD96\uDE45-\uDE47\uDE4B-\uDE4F\uDEA3\uDEB4-\uDEB6\uDEC0\uDECC]|\uD83E[\uDD0C\uDD0F\uDD18-\uDD1F\uDD26\uDD30-\uDD39\uDD3C-\uDD3E\uDD77\uDDB5\uDDB6\uDDB8\uDDB9\uDDBB\uDDCD-\uDDCF\uDDD1-\uDDDD])/g});function yt(e,t={}){if(typeof e!=`string`||e.length===0||(t={ambiguousIsNarrow:!0,...t},e=pt(e),e.length===0))return 0;e=e.replace(vt(),`  `);let n=t.ambiguousIsNarrow?1:2,r=0;for(let t of e){let e=t.codePointAt(0);if(!(e<=31||e>=127&&e<=159||e>=768&&e<=879))switch(_t.eastAsianWidth(t)){case`F`:case`W`:r+=2;break;case`A`:r+=n;break;default:r+=1}}return r}const bt=(e=0)=>t=>`\x1B[${t+e}m`,xt=(e=0)=>t=>`\x1B[${38+e};5;${t}m`,St=(e=0)=>(t,n,r)=>`\x1B[${38+e};2;${t};${n};${r}m`,P={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],gray:[90,39],grey:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgGray:[100,49],bgGrey:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};Object.keys(P.modifier);const Ct=Object.keys(P.color),wt=Object.keys(P.bgColor);[...Ct,...wt];function Tt(){let e=new Map;for(let[t,n]of Object.entries(P)){for(let[t,r]of Object.entries(n))P[t]={open:`\x1B[${r[0]}m`,close:`\x1B[${r[1]}m`},n[t]=P[t],e.set(r[0],r[1]);Object.defineProperty(P,t,{value:n,enumerable:!1})}return Object.defineProperty(P,`codes`,{value:e,enumerable:!1}),P.color.close=`\x1B[39m`,P.bgColor.close=`\x1B[49m`,P.color.ansi=bt(),P.color.ansi256=xt(),P.color.ansi16m=St(),P.bgColor.ansi=bt(10),P.bgColor.ansi256=xt(10),P.bgColor.ansi16m=St(10),Object.defineProperties(P,{rgbToAnsi256:{value:(e,t,n)=>e===t&&t===n?e<8?16:e>248?231:Math.round((e-8)/247*24)+232:16+36*Math.round(e/255*5)+6*Math.round(t/255*5)+Math.round(n/255*5),enumerable:!1},hexToRgb:{value:e=>{let t=/[a-f\d]{6}|[a-f\d]{3}/i.exec(e.toString(16));if(!t)return[0,0,0];let[n]=t;n.length===3&&(n=[...n].map(e=>e+e).join(``));let r=Number.parseInt(n,16);return[r>>16&255,r>>8&255,r&255]},enumerable:!1},hexToAnsi256:{value:e=>P.rgbToAnsi256(...P.hexToRgb(e)),enumerable:!1},ansi256ToAnsi:{value:e=>{if(e<8)return 30+e;if(e<16)return 90+(e-8);let t,n,r;if(e>=232)t=((e-232)*10+8)/255,n=t,r=t;else{e-=16;let i=e%36;t=Math.floor(e/36)/5,n=Math.floor(i/6)/5,r=i%6/5}let i=Math.max(t,n,r)*2;if(i===0)return 30;let a=30+(Math.round(r)<<2|Math.round(n)<<1|Math.round(t));return i===2&&(a+=60),a},enumerable:!1},rgbToAnsi:{value:(e,t,n)=>P.ansi256ToAnsi(P.rgbToAnsi256(e,t,n)),enumerable:!1},hexToAnsi:{value:e=>P.ansi256ToAnsi(P.hexToAnsi256(e)),enumerable:!1}}),P}const Et=Tt(),Dt=new Set([`\x1B`,``]),Ot=`]8;;`,kt=e=>`${Dt.values().next().value}[${e}m`,At=e=>`${Dt.values().next().value}${Ot}${e}`,jt=e=>e.split(` `).map(e=>yt(e)),Mt=(e,t,n)=>{let r=[...t],i=!1,a=!1,o=yt(pt(e[e.length-1]));for(let[t,s]of r.entries()){let c=yt(s);if(o+c<=n?e[e.length-1]+=s:(e.push(s),o=0),Dt.has(s)&&(i=!0,a=r.slice(t+1).join(``).startsWith(Ot)),i){a?s===`\x07`&&(i=!1,a=!1):s===`m`&&(i=!1);continue}o+=c,o===n&&t<r.length-1&&(e.push(``),o=0)}!o&&e[e.length-1].length>0&&e.length>1&&(e[e.length-2]+=e.pop())},Nt=e=>{let t=e.split(` `),n=t.length;for(;n>0&&!(yt(t[n-1])>0);)n--;return n===t.length?e:t.slice(0,n).join(` `)+t.slice(n).join(``)},Pt=(e,t,n={})=>{if(n.trim!==!1&&e.trim()===``)return``;let r=``,i,a,o=jt(e),s=[``];for(let[r,i]of e.split(` `).entries()){n.trim!==!1&&(s[s.length-1]=s[s.length-1].trimStart());let e=yt(s[s.length-1]);if(r!==0&&(e>=t&&(n.wordWrap===!1||n.trim===!1)&&(s.push(``),e=0),(e>0||n.trim===!1)&&(s[s.length-1]+=` `,e++)),n.hard&&o[r]>t){let n=t-e,a=1+Math.floor((o[r]-n-1)/t);Math.floor((o[r]-1)/t)<a&&s.push(``),Mt(s,i,t);continue}if(e+o[r]>t&&e>0&&o[r]>0){if(n.wordWrap===!1&&e<t){Mt(s,i,t);continue}s.push(``)}if(e+o[r]>t&&n.wordWrap===!1){Mt(s,i,t);continue}s[s.length-1]+=i}n.trim!==!1&&(s=s.map(e=>Nt(e)));let c=[...s.join(`
`)];for(let[e,t]of c.entries()){if(r+=t,Dt.has(t)){let{groups:t}=RegExp(`(?:\\[(?<code>\\d+)m|\\${Ot}(?<uri>.*))`).exec(c.slice(e).join(``))||{groups:{}};if(t.code!==void 0){let e=Number.parseFloat(t.code);i=e===39?void 0:e}else t.uri!==void 0&&(a=t.uri.length===0?void 0:t.uri)}let n=Et.codes.get(Number(i));c[e+1]===`
`?(a&&(r+=At(``)),i&&n&&(r+=kt(n))):t===`
`&&(i&&n&&(r+=kt(i)),a&&(r+=At(a)))}return r};function Ft(e,t,n){return String(e).normalize().replace(/\r\n/g,`
`).split(`
`).map(e=>Pt(e,t,n)).join(`
`)}const It={actions:new Set([`up`,`down`,`left`,`right`,`space`,`enter`,`cancel`]),aliases:new Map([[`k`,`up`],[`j`,`down`],[`h`,`left`],[`l`,`right`],[``,`cancel`],[`escape`,`cancel`]])};function Lt(e,t){if(typeof e==`string`)return It.aliases.get(e)===t;for(let n of e)if(n!==void 0&&Lt(n,t))return!0;return!1}function Rt(e,t){if(e===t)return;let n=e.split(`
`),r=t.split(`
`),i=[];for(let e=0;e<Math.max(n.length,r.length);e++)n[e]!==r[e]&&i.push(e);return i}const zt=globalThis.process.platform.startsWith(`win`),Bt=Symbol(`clack:cancel`);function Vt(e,t){let n=e;n.isTTY&&n.setRawMode(t)}function Ht({input:e=o,output:t=s,overwrite:n=!0,hideCursor:r=!0}={}){let i=c.createInterface({input:e,output:t,prompt:``,tabSize:1});c.emitKeypressEvents(e,i),e.isTTY&&e.setRawMode(!0);let a=(i,{name:o,sequence:s})=>{if(Lt([String(i),o,s],`cancel`)){r&&t.write(N.cursor.show),process.exit(0);return}if(!n)return;let l=o===`return`?0:-1,u=o===`return`?-1:0;c.moveCursor(t,l,u,()=>{c.clearLine(t,1,()=>{e.once(`keypress`,a)})})};return r&&t.write(N.cursor.hide),e.once(`keypress`,a),()=>{e.off(`keypress`,a),r&&t.write(N.cursor.show),e.isTTY&&!zt&&e.setRawMode(!1),i.terminal=!1,i.close()}}var Ut=Object.defineProperty,Wt=(e,t,n)=>t in e?Ut(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,F=(e,t,n)=>(Wt(e,typeof t==`symbol`?t:t+``,n),n),Gt=class{constructor(e,t=!0){F(this,`input`),F(this,`output`),F(this,`_abortSignal`),F(this,`rl`),F(this,`opts`),F(this,`_render`),F(this,`_track`,!1),F(this,`_prevFrame`,``),F(this,`_subscribers`,new Map),F(this,`_cursor`,0),F(this,`state`,`initial`),F(this,`error`,``),F(this,`value`);let{input:n=o,output:r=s,render:i,signal:a,...c}=e;this.opts=c,this.onKeypress=this.onKeypress.bind(this),this.close=this.close.bind(this),this.render=this.render.bind(this),this._render=i.bind(this),this._track=t,this._abortSignal=a,this.input=n,this.output=r}unsubscribe(){this._subscribers.clear()}setSubscriber(e,t){let n=this._subscribers.get(e)??[];n.push(t),this._subscribers.set(e,n)}on(e,t){this.setSubscriber(e,{cb:t})}once(e,t){this.setSubscriber(e,{cb:t,once:!0})}emit(e,...t){let n=this._subscribers.get(e)??[],r=[];for(let e of n)e.cb(...t),e.once&&r.push(()=>n.splice(n.indexOf(e),1));for(let e of r)e()}prompt(){return new Promise((e,t)=>{if(this._abortSignal){if(this._abortSignal.aborted)return this.state=`cancel`,this.close(),e(Bt);this._abortSignal.addEventListener(`abort`,()=>{this.state=`cancel`,this.close()},{once:!0})}let n=new u;n._write=(e,t,n)=>{this._track&&(this.value=this.rl?.line.replace(/\t/g,``),this._cursor=this.rl?.cursor??0,this.emit(`value`,this.value)),n()},this.input.pipe(n),this.rl=l.createInterface({input:this.input,output:n,tabSize:2,prompt:``,escapeCodeTimeout:50,terminal:!0}),l.emitKeypressEvents(this.input,this.rl),this.rl.prompt(),this.opts.initialValue!==void 0&&this._track&&this.rl.write(this.opts.initialValue),this.input.on(`keypress`,this.onKeypress),Vt(this.input,!0),this.output.on(`resize`,this.render),this.render(),this.once(`submit`,()=>{this.output.write(N.cursor.show),this.output.off(`resize`,this.render),Vt(this.input,!1),e(this.value)}),this.once(`cancel`,()=>{this.output.write(N.cursor.show),this.output.off(`resize`,this.render),Vt(this.input,!1),e(Bt)})})}onKeypress(e,t){if(this.state===`error`&&(this.state=`active`),t?.name&&(!this._track&&It.aliases.has(t.name)&&this.emit(`cursor`,It.aliases.get(t.name)),It.actions.has(t.name)&&this.emit(`cursor`,t.name)),e&&(e.toLowerCase()===`y`||e.toLowerCase()===`n`)&&this.emit(`confirm`,e.toLowerCase()===`y`),e===`	`&&this.opts.placeholder&&(this.value||(this.rl?.write(this.opts.placeholder),this.emit(`value`,this.opts.placeholder))),e&&this.emit(`key`,e.toLowerCase()),t?.name===`return`){if(this.opts.validate){let e=this.opts.validate(this.value);e&&(this.error=e instanceof Error?e.message:e,this.state=`error`,this.rl?.write(this.value))}this.state!==`error`&&(this.state=`submit`)}Lt([e,t?.name,t?.sequence],`cancel`)&&(this.state=`cancel`),(this.state===`submit`||this.state===`cancel`)&&this.emit(`finalize`),this.render(),(this.state===`submit`||this.state===`cancel`)&&this.close()}close(){this.input.unpipe(),this.input.removeListener(`keypress`,this.onKeypress),this.output.write(`
`),Vt(this.input,!1),this.rl?.close(),this.rl=void 0,this.emit(`${this.state}`,this.value),this.unsubscribe()}restoreCursor(){let e=Ft(this._prevFrame,process.stdout.columns,{hard:!0}).split(`
`).length-1;this.output.write(N.cursor.move(-999,e*-1))}render(){let e=Ft(this._render(this)??``,process.stdout.columns,{hard:!0});if(e!==this._prevFrame){if(this.state===`initial`)this.output.write(N.cursor.hide);else{let t=Rt(this._prevFrame,e);if(this.restoreCursor(),t&&t?.length===1){let n=t[0];this.output.write(N.cursor.move(0,n)),this.output.write(N.erase.lines(1));let r=e.split(`
`);this.output.write(r[n]),this._prevFrame=e,this.output.write(N.cursor.move(0,r.length-n-1));return}if(t&&t?.length>1){let n=t[0];this.output.write(N.cursor.move(0,n)),this.output.write(N.erase.down());let r=e.split(`
`).slice(n);this.output.write(r.join(`
`)),this._prevFrame=e;return}this.output.write(N.erase.down())}this.output.write(e),this.state===`initial`&&(this.state=`active`),this._prevFrame=e}}},Kt=class extends Gt{get cursor(){return this.value?0:1}get _value(){return this.cursor===0}constructor(e){super(e,!1),this.value=!!e.initialValue,this.on(`value`,()=>{this.value=this._value}),this.on(`confirm`,e=>{this.output.write(N.cursor.move(0,-1)),this.value=e,this.state=`submit`,this.close()}),this.on(`cursor`,()=>{this.value=!this.value})}};Object.defineProperty,Object.defineProperty,Object.defineProperty,Object.defineProperty,Object.defineProperty;var I=ct(ut(),1),qt=ct(lt(),1);function Jt(){return a.platform===`win32`?!!a.env.CI||!!a.env.WT_SESSION||!!a.env.TERMINUS_SUBLIME||a.env.ConEmuTask===`{cmd::Cmder}`||a.env.TERM_PROGRAM===`Terminus-Sublime`||a.env.TERM_PROGRAM===`vscode`||a.env.TERM===`xterm-256color`||a.env.TERM===`alacritty`||a.env.TERMINAL_EMULATOR===`JetBrains-JediTerm`:a.env.TERM!==`linux`}const Yt=Jt(),L=(e,t)=>Yt?e:t,Xt=L(`◆`,`*`),Zt=L(`■`,`x`),Qt=L(`▲`,`x`),$t=L(`◇`,`o`),en=L(`┌`,`T`),R=L(`│`,`|`),tn=L(`└`,`—`),nn=L(`●`,`>`),rn=L(`○`,` `),an=L(`●`,`•`),on=L(`◆`,`*`),sn=L(`▲`,`!`),cn=L(`■`,`x`),ln=e=>{switch(e){case`initial`:case`active`:return I.default.cyan(Xt);case`cancel`:return I.default.red(Zt);case`error`:return I.default.yellow(Qt);case`submit`:return I.default.green($t)}},un=e=>{let t=e.active??`Yes`,n=e.inactive??`No`;return new Kt({active:t,inactive:n,initialValue:e.initialValue??!0,render(){let r=`${I.default.gray(R)}
${ln(this.state)}  ${e.message}
`,i=this.value?t:n;switch(this.state){case`submit`:return`${r}${I.default.gray(R)}  ${I.default.dim(i)}`;case`cancel`:return`${r}${I.default.gray(R)}  ${I.default.strikethrough(I.default.dim(i))}
${I.default.gray(R)}`;default:return`${r}${I.default.cyan(R)}  ${this.value?`${I.default.green(nn)} ${t}`:`${I.default.dim(rn)} ${I.default.dim(t)}`} ${I.default.dim(`/`)} ${this.value?`${I.default.dim(rn)} ${I.default.dim(n)}`:`${I.default.green(nn)} ${n}`}
${I.default.cyan(tn)}
`}}}).prompt()},dn=(e=``)=>{process.stdout.write(`${I.default.gray(en)}  ${e}
`)},z={message:(e=``,{symbol:t=I.default.gray(R)}={})=>{let n=[`${I.default.gray(R)}`];if(e){let[r,...i]=e.split(`
`);n.push(`${t}  ${r}`,...i.map(e=>`${I.default.gray(R)}  ${e}`))}process.stdout.write(`${n.join(`
`)}
`)},info:e=>{z.message(e,{symbol:I.default.blue(an)})},success:e=>{z.message(e,{symbol:I.default.green(on)})},step:e=>{z.message(e,{symbol:I.default.green($t)})},warn:e=>{z.message(e,{symbol:I.default.yellow(sn)})},warning:e=>{z.warn(e)},error:e=>{z.message(e,{symbol:I.default.red(cn)})}},fn=`${I.default.gray(R)}  `,pn={message:async(e,{symbol:t=I.default.gray(R)}={})=>{process.stdout.write(`${I.default.gray(R)}
${t}  `);let n=3;for await(let t of e){t=t.replace(/\n/g,`
${fn}`),t.includes(`
`)&&(n=3+i(t.slice(t.lastIndexOf(`
`))).length);let e=i(t).length;n+e<process.stdout.columns?(n+=e,process.stdout.write(t)):(process.stdout.write(`
${fn}${t.trimStart()}`),n=3+i(t.trimStart()).length)}process.stdout.write(`
`)},info:e=>pn.message(e,{symbol:I.default.blue(an)}),success:e=>pn.message(e,{symbol:I.default.green(on)}),step:e=>pn.message(e,{symbol:I.default.green($t)}),warn:e=>pn.message(e,{symbol:I.default.yellow(sn)}),warning:e=>pn.warn(e),error:e=>pn.message(e,{symbol:I.default.red(cn)})},mn=({indicator:e=`dots`}={})=>{let t=Yt?[`◒`,`◐`,`◓`,`◑`]:[`•`,`o`,`O`,`0`],n=Yt?80:120,r=process.env.CI===`true`,i,a,o=!1,s=``,c,l=performance.now(),u=e=>{o&&y(e>1?`Something went wrong`:`Canceled`,e)},d=()=>u(2),f=()=>u(1),p=()=>{process.on(`uncaughtExceptionMonitor`,d),process.on(`unhandledRejection`,d),process.on(`SIGINT`,f),process.on(`SIGTERM`,f),process.on(`exit`,u)},m=()=>{process.removeListener(`uncaughtExceptionMonitor`,d),process.removeListener(`unhandledRejection`,d),process.removeListener(`SIGINT`,f),process.removeListener(`SIGTERM`,f),process.removeListener(`exit`,u)},h=()=>{if(c===void 0)return;r&&process.stdout.write(`
`);let e=c.split(`
`);process.stdout.write(qt.cursor.move(-999,e.length-1)),process.stdout.write(qt.erase.down(e.length))},g=e=>e.replace(/\.+$/,``),_=e=>{let t=(performance.now()-e)/1e3,n=Math.floor(t/60),r=Math.floor(t%60);return n>0?`[${n}m ${r}s]`:`[${r}s]`},v=(u=``)=>{o=!0,i=Ht(),s=g(u),l=performance.now(),process.stdout.write(`${I.default.gray(R)}
`);let d=0,f=0;p(),a=setInterval(()=>{if(r&&s===c)return;h(),c=s;let n=I.default.magenta(t[d]);if(r)process.stdout.write(`${n}  ${s}...`);else if(e===`timer`)process.stdout.write(`${n}  ${s} ${_(l)}`);else{let e=`.`.repeat(Math.floor(f)).slice(0,3);process.stdout.write(`${n}  ${s}${e}`)}d=d+1<t.length?d+1:0,f=f<t.length?f+.125:0},n)},y=(t=``,n=0)=>{o=!1,clearInterval(a),h();let r=n===0?I.default.green($t):n===1?I.default.red(Zt):I.default.red(Qt);s=g(t??s),e===`timer`?process.stdout.write(`${r}  ${s} ${_(l)}
`):process.stdout.write(`${r}  ${s}
`),m(),i()};return{start:v,stop:y,message:(e=``)=>{s=g(e??s)}}};var hn=ot({arbitrum:()=>ie,arbitrumSepolia:()=>ae,base:()=>oe,baseSepolia:()=>se,berachain:()=>ce,berachainBepolia:()=>le,bsc:()=>ue,celo:()=>de,gnosis:()=>fe,hoodi:()=>pe,katana:()=>me,mainnet:()=>he,optimism:()=>ge,optimismSepolia:()=>_e,polygon:()=>ve,sepolia:()=>ye});const gn=[oe,...Object.values(hn).filter(e=>e&&e.id!==oe.id)],_n=re;({..._n}),{..._n};const vn=`0x3232323232323232323232323232323232323232`,yn=`0x32323232`,bn={p256:`p256`,secp256k1:`secp256k1`,webauthnp256:`webauthn-p256`},xn={admin:`admin`,normal:`session`},Sn={0:`minute`,1:`hour`,2:`day`,3:`week`,4:`month`,5:`year`},Cn={address:`secp256k1`,p256:`p256`,secp256k1:`secp256k1`,"webauthn-p256":`webauthnp256`},wn={admin:`admin`,session:`normal`},Tn={address:2,p256:0,secp256k1:2,"webauthn-p256":1},En={day:2,hour:1,minute:0,month:4,week:3,year:5};function Dn(e={}){let t=we.randomPrivateKey();return Mn({...e,privateKey:t})}function On(e={}){let t=k.randomPrivateKey();return Pn({...e,privateKey:t})}async function kn(e){let{createFn:t,label:n,rpId:r,userId:i}=e,a=await Oe.createCredential({authenticatorSelection:{requireResidentKey:!0,residentKey:`required`,userVerification:`required`},createFn:t,extensions:{credProps:!0},rp:r?{id:r,name:r}:void 0,user:{displayName:n,id:new Uint8Array(i??E.fromString(n)),name:n}});return Fn({...e,credential:{id:a.id,publicKey:a.publicKey},id:i?E.toHex(i):O.toHex(a.publicKey,{includePrefix:!1})})}function An(e={}){let t=we.randomPrivateKey();return In({...e,privateKey:t})}async function jn(e={}){let t=await ke.createKeyPair();return Ln({...e,keyPair:t})}function B(e,t={}){let{chainId:n=e.chainId}=t,{expiry:r=0,id:i,prehash:a=!1,role:o=`admin`,type:s}=e,c=(()=>{let t=e.publicKey;return t===`0x`?t:s===`secp256k1`||s===`address`?D.size(t)===20||D.toBigInt(D.slice(t,0,12))===0n?D.slice(t,-20):T.fromPublicKey(O.fromHex(t)):t})();return{...e,chainId:n,expiry:r,hash:Rn({publicKey:c,type:s}),id:(i??c).toLowerCase(),prehash:a,publicKey:c.toLowerCase(),role:o,type:s}}function Mn(e){let{chainId:t,expiry:n,feeToken:r,permissions:i,privateKey:a,role:o}=e;return B({chainId:t,expiry:n,feeToken:r,permissions:i,privateKey(){return a},publicKey:O.toHex(we.getPublicKey({privateKey:a}),{includePrefix:!1}),role:o,type:`p256`})}function Nn(e,t){let{chainId:n}=t,{publicKey:r}=e,i=D.size(r)===20||D.toBigInt(D.slice(r,0,12))===0n,a={};for(let t of e.permissions)t.type===`call`&&(a.calls??=[],a.calls.push({signature:t.selector,to:t.to===vn?void 0:t.to})),t.type===`spend`&&(a.spend??=[],a.spend.push({limit:t.limit,period:t.period,token:t.token}));return B({chainId:n,expiry:e.expiry,permissions:a,publicKey:e.publicKey,role:xn[e.role],type:i?`address`:bn[e.type]})}function Pn(e){let{privateKey:t,role:n}=e,r=(()=>e.publicKey?e.publicKey:t?T.fromPublicKey(k.getPublicKey({privateKey:t})):e.address.toLowerCase())();return B({expiry:e.expiry??0,feeToken:e.feeToken,permissions:e.permissions,privateKey:t?()=>t:void 0,publicKey:r,role:n,type:`secp256k1`})}function Fn(e){let{credential:t,id:n,rpId:r}=e,i=O.toHex(t.publicKey,{includePrefix:!1});return B({chainId:e.chainId,expiry:e.expiry??0,feeToken:e.feeToken,id:n,permissions:e.permissions,privateKey:{credential:t,rpId:r},publicKey:i,role:e.role,type:`webauthn-p256`})}function In(e){let{privateKey:t}=e,n=O.toHex(we.getPublicKey({privateKey:t}),{includePrefix:!1});return B({chainId:e.chainId,expiry:e.expiry??0,feeToken:e.feeToken,permissions:e.permissions,privateKey:{privateKey(){return t}},publicKey:n,role:e.role,type:`webauthn-p256`})}function Ln(e){let{chainId:t,expiry:n,feeToken:r,keyPair:i,permissions:a,role:o}=e,{privateKey:s}=i;return B({chainId:t,expiry:n,feeToken:r,permissions:a,prehash:!0,privateKey:s,publicKey:O.toHex(i.publicKey,{includePrefix:!1}),role:o,type:`p256`})}function Rn(e){let{type:t}=e,n=zn(e.publicKey);return Se.keccak256(xe.encode([{type:`uint8`},{type:`bytes32`}],[Tn[t],Se.keccak256(n)]))}function zn(e){return D.size(e)<32?D.padLeft(e,32):e}async function V(e,t){let{address:n,storage:r,webAuthn:i,wrap:a=!0}=t,{privateKey:o,publicKey:s,type:c}=e;if(!o)throw Error(`Key does not have a private key to sign with.

Key:
`+Ce.stringify(e,null,2));let l=(()=>n?Ee.getSignPayload({domain:{verifyingContract:n},message:{digest:t.payload},primaryType:`ERC1271Sign`,types:{ERC1271Sign:[{name:`digest`,type:`bytes32`}]}}):t.payload)(),[u,d]=await(async()=>{if(c===`p256`){let{privateKey:t}=e;if(typeof t==`function`)return[Te.toHex(we.sign({payload:l,privateKey:t()})),!1];if(t instanceof CryptoKey)return[Te.toHex(await ke.sign({payload:l,privateKey:t})),!0]}if(c===`secp256k1`)return[Te.toHex(k.sign({payload:l,privateKey:o()})),!1];if(c===`webauthn-p256`){if(o.privateKey){let{payload:e,metadata:t}=Oe.getSignPayload({challenge:l,origin:`https://ithaca.xyz`,rpId:`ithaca.xyz`}),{r:n,s:r}=we.sign({hash:!0,payload:e,privateKey:o.privateKey()});return[Un({metadata:t,signature:{r:n,s:r}}),!1]}let{credential:t,rpId:n}=o,a=`porto.webauthnVerified.${e.hash}`,s=Date.now(),c=!0;if(r){let e=await r.getItem(a);c=!e||s-e>6e5}let{signature:{r:u,s:d},raw:f,metadata:p}=await Oe.sign({challenge:l,credentialId:t.id,getFn:i?.getFn,rpId:n,userVerification:c?`required`:`preferred`}),m=f.response;if(!m?.userHandle)throw Error(`No user handle in response`,{cause:{response:m}});let h=E.toHex(new Uint8Array(m.userHandle));if(e.id&&T.validate(e.id)&&!T.isEqual(e.id,h))throw Error(`supplied webauthn key "${e.id}" does not match signature webauthn key "${h}"`,{cause:{id:h,key:e}});return c&&r&&await r.setItem(a,s),[Un({metadata:p,signature:{r:u,s:d}}),!1]}throw Error(`Key type "${c}" is not supported.\n\nKey:\n`+Ce.stringify(e,null,2))})();return a?Wn(u,{keyType:c,prehash:d,publicKey:s}):u}function Bn(e,t={}){let{expiry:n=0,prehash:r=!1,publicKey:i,role:a=`admin`,type:o}=e,{feeTokens:s,orchestrator:c}=t,l=Object.entries(Vn(e,{feeTokens:s})).map(([e,t])=>{if(e===`calls`)return t.map(({signature:e,to:t})=>({selector:(()=>e?D.validate(e)?e:be.getSelector(e):yn)(),to:t??vn,type:`call`}));if(e!==`feeToken`){if(e===`spend`)return t.map(({limit:e,period:t,token:n})=>({limit:e,period:t,token:n,type:`spend`}));throw Error(`Invalid permission type "${e}".`)}}).flat().filter(Boolean);return e.role===`session`&&c&&l.push({selector:yn,to:c,type:`call`}),{expiry:n,permissions:l??[],prehash:r,publicKey:zn(i),role:wn[a],type:Cn[o]}}function Vn(e,t){let{permissions:n}=e,r=n?.calls?[...n.calls]:[],i=n?.spend?[...n.spend]:[],a=t.feeTokens?.filter(e=>e.feeToken);if(a&&a.length>0){let t=Hn(e,{feeTokens:a});if(t){let e=-1,n=En.year;for(let r=0;r<i.length;r++){let a=i[r];if(a.token&&T.isEqual(t.address,a.token)){e=r;break}if(!a.token&&t.address===S){e=r;break}let o=En[a.period];o<n&&(n=o)}e===-1?typeof n==`number`&&i.unshift({limit:t.value,period:Sn[n],token:t.address}):(i[e]={...i[e],limit:i[e].limit+t.value},i.unshift(i.splice(e,1)[0]))}}return{...n,calls:r,spend:i}}function Hn(e,t){let{feeTokens:n}=t;if(!e.feeToken)return;let r=n.find(t=>e.feeToken.symbol===t.symbol?!0:!e.feeToken.symbol||e.feeToken.symbol===`native`?t.address===S:!1);if(!r)return;let i=De.from(e.feeToken.limit,r.decimals);return{...r,value:i}}function Un(e){let{metadata:t,signature:n}=e;return xe.encode(xe.from([`struct WebAuthnAuth { bytes authenticatorData; string clientDataJSON; uint256 challengeIndex; uint256 typeIndex; bytes32 r; bytes32 s; }`,`WebAuthnAuth auth`]),[{authenticatorData:t.authenticatorData,challengeIndex:BigInt(t.challengeIndex),clientDataJSON:t.clientDataJSON,r:D.fromNumber(n.r,{size:32}),s:D.fromNumber(n.s,{size:32}),typeIndex:BigInt(t.typeIndex)}])}function Wn(e,t){let{keyType:n,prehash:r=!1,publicKey:i}=t,a=Rn({publicKey:i,type:n});return xe.encodePacked([`bytes`,`bytes32`,`bool`],[e,a,r])}const H=()=>A.templateLiteral([`0x`,A.string()],{message:`Needs string in format ^0x[A-Fa-f0-9]{40}$.`}),U=()=>A.templateLiteral([`0x`,A.string()],{message:`Needs string in format ^0x[A-Fa-f0-9]+$.`}),W=()=>A.codec(U(),A.number(),{decode:e=>D.toNumber(e),encode:e=>D.fromNumber(e)}),G=()=>A.codec(U(),A.bigint({message:`Required bigint`}),{decode:e=>D.toBigInt(e),encode:e=>D.fromNumber(e)});function Gn(e){return A.union(e)}var Kn=class extends Ae.BaseError{constructor(...e){super(...e),this.name=`Schema.ValidationError`}};function qn(e){let t=e,n=`Validation failed with ${t.issues.length} error${t.issues.length===1?``:`s`}:`;n+=`
`;for(let e of t.issues)e&&(n+=`
`,n+=Jn(e));return new Kn(n)}function Jn(e,t=0){let n=Yn(e.path),r=`- ${n?`${n}: `:``}`,i=`  `.repeat(t+1),a=r;switch(e.code){case`invalid_type`:{let t=e.expected,n=e.input?Xn(e):`undefined`;a+=`Expected ${t}. ${e.message===`Invalid input`?``:e.message}`,n!==`undefined`&&(a+=`but received ${n}`);break}case`too_big`:{let t=e.maximum,n=e.inclusive??!0;e.exact??!1?a+=`${e.origin} must be exactly ${t}`:a+=`${e.origin} must be ${n?`at most`:`less than`} ${t}`;break}case`too_small`:{let t=e.minimum,n=e.inclusive??!0;e.exact??!1?a+=`${e.origin} must be exactly ${t}`:a+=`${e.origin} must be ${n?`at least`:`greater than`} ${t}`;break}case`invalid_format`:switch(e.format){case`regex`:a+=`Must match pattern: ${e.pattern}`;break;case`starts_with`:a+=`Must start with "${e.prefix}"`;break;case`ends_with`:a+=`Must end with "${e.suffix}"`;break;case`includes`:a+=`Must include "${e.includes}"`;break;case`template_literal`:a+=`Must match pattern: ${e.pattern}`;break;default:a+=`Invalid ${e.format} format`}break;case`not_multiple_of`:a+=`Number must be a multiple of ${e.divisor}`;break;case`unrecognized_keys`:{let t=e.keys.map(e=>`"${e}"`).join(`, `);a+=`Unrecognized key${e.keys.length>1?`s`:``}: ${t}`;break}case`invalid_union`:{let n=e.errors&&e.errors.length>0;a+=`Invalid union value.`,n&&e.errors.forEach(e=>{e.length>0&&e.forEach(e=>{a+=`
`,a+=i,a+=Jn(e,t+1)})});break}case`invalid_key`:a+=`Invalid ${e.origin} key`,e.issues&&e.issues.length>0&&e.issues.forEach(e=>{a+=`
`,a+=i,a+=Jn(e,t+1)});break;case`invalid_element`:a+=`Invalid ${e.origin} element at key "${e.key}"`,e.issues&&e.issues.length>0&&e.issues.forEach(e=>{a+=`
`,a+=i,a+=Jn(e,t+1)});break;case`invalid_value`:{let t=e.values.map(e=>JSON.stringify(e)).join(`, `);e.values.length>1?a+=`Expected one of: ${t}`:a+=`Expected ${t}`;break}case`custom`:a+=e.message||`Custom validation failed`;break;default:a+=e.message||`Validation failed`}return a}function Yn(e){return e.length===0?``:"at `"+e.map((e,t)=>typeof e==`number`?`[${e}]`:typeof e==`symbol`?`[${e.toString()}]`:/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(e)&&t>0?`.${e}`:t===0&&/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(e)?e:`["${e}"]`).join(``)+"`"}function Xn(e){let t=e.input;if(t===void 0)return`undefined`;if(t===null)return`null`;let n=typeof t;return n===`object`?Array.isArray(t)?`array`:t instanceof Date?`date`:t instanceof Map?`map`:t instanceof Set?`set`:`object`:n}const Zn=A.union([A.object({combinedGas:G(),encodedFundTransfers:A.readonly(A.array(U())),encodedPreCalls:A.readonly(A.array(U())),eoa:H(),executionData:U(),expiry:G(),funder:H(),funderSignature:U(),isMultichain:A.boolean(),nonce:G(),payer:H(),paymentAmount:G(),paymentMaxAmount:G(),paymentRecipient:H(),paymentSignature:U(),paymentToken:H(),settler:H(),settlerContext:U(),signature:U(),supportedAccountImplementation:H()}),A.object({combinedGas:G(),encodedFundTransfers:A.readonly(A.array(U())),encodedPreCalls:A.readonly(A.array(U())),eoa:H(),executionData:U(),expiry:G(),funder:H(),funderSignature:U(),isMultichain:A.boolean(),nonce:G(),payer:H(),paymentRecipient:H(),paymentSignature:U(),paymentToken:H(),prePaymentAmount:G(),prePaymentMaxAmount:G(),settler:H(),settlerContext:U(),signature:U(),supportedAccountImplementation:H(),totalPaymentAmount:G(),totalPaymentMaxAmount:G()})]);A.object({eoa:H(),executionData:U(),nonce:G()});const Qn=j.object({address:j.union([H(),j.null()]),decimals:j.optional(j.number()),deficit:G(),fiat:j.optional(j.object({currency:j.string(),value:j.string()})),name:j.optional(j.string()),required:G(),symbol:j.optional(j.string())}),$n=j.object({additionalAuthorization:j.nullish(j.object({address:H(),chainId:W(),nonce:W(),r:U(),s:U(),yParity:W()})),assetDeficits:j.optional(j.array(Qn)),authorizationAddress:j.optional(j.union([H(),j.null()])),chainId:W(),ethPrice:G(),extraPayment:G(),feeTokenDeficit:G(),intent:Zn,nativeFeeEstimate:j.object({maxFeePerGas:G(),maxPriorityFeePerGas:G()}),orchestrator:H(),paymentTokenDecimals:j.number(),txGas:G()}),er=j.object({multiChainRoot:j.optional(j.union([U(),j.null()])),quotes:j.readonly(j.array($n)).check(j.minLength(1)),ttl:j.number()}),tr=j.object({...er.shape,hash:U(),r:U(),s:U(),v:j.optional(U()),yParity:j.optional(U())}),nr=A.object({selector:U(),to:H(),type:A.literal(`call`)}),rr=A.object({limit:G(),period:A.union([A.literal(`minute`),A.literal(`hour`),A.literal(`day`),A.literal(`week`),A.literal(`month`),A.literal(`year`)]),token:A.optional(A.union([H(),A.null()])),type:A.literal(`spend`)}),ir=A.union([nr,rr]),ar=A.object({expiry:W(),prehash:A.optional(A.boolean()),publicKey:U(),role:A.union([A.literal(`admin`),A.literal(`normal`)]),type:A.union([A.literal(`p256`),A.literal(`secp256k1`),A.literal(`webauthnp256`)])}),or=A.object({...ar.shape,permissions:A.readonly(A.array(ir))});let sr;(function(e){let t=e.AssetDiffAsset=A.union([A.object({address:A.optional(A.union([H(),A.null()])),decimals:A.optional(A.union([A.number(),A.null()])),direction:A.union([A.literal(`incoming`),A.literal(`outgoing`)]),fiat:A.optional(A.object({currency:A.string(),value:A.codec(A.string(),A.number(),{decode:e=>Number(e),encode:e=>String(e)})})),name:A.optional(A.union([A.string(),A.null()])),symbol:A.string(),type:A.literal(`erc20`),value:G()}),A.object({address:A.optional(A.union([H(),A.null()])),direction:A.union([A.literal(`incoming`),A.literal(`outgoing`)]),fiat:A.optional(A.object({currency:A.string(),value:A.codec(A.string(),A.number(),{decode:e=>Number(e),encode:e=>String(e)})})),name:A.optional(A.union([A.string(),A.null()])),symbol:A.string(),type:A.literal(`erc721`),uri:A.string(),value:G()}),A.object({address:A.null(),decimals:A.optional(A.union([A.number(),A.null()])),direction:A.union([A.literal(`incoming`),A.literal(`outgoing`)]),fiat:A.optional(A.object({currency:A.string(),value:A.codec(A.string(),A.number(),{decode:e=>Number(e),encode:e=>String(e)})})),symbol:A.string(),type:A.null(),value:G()})]);e.Response=A.record(U(),A.readonly(A.array(A.readonly(A.tuple([H(),A.readonly(A.array(t))])))))})(sr||={});let cr;(function(e){e.Request=A.readonly(A.array(or)),e.Response=A.readonly(A.array(A.object({...or.shape,hash:U()})))})(cr||={});let lr;(function(e){e.Response=A.record(U(),A.object({currency:A.string(),value:A.string()}))})(lr||={});let ur;(function(e){e.Request=A.object({feePayer:A.optional(H()),feeToken:A.optional(H()),nonce:A.optional(G())})})(ur||={});let dr;(function(e){e.Request=A.readonly(A.array(A.object({address:H(),value:G()})))})(dr||={});let fr;(function(e){e.Request=A.readonly(A.array(A.object({hash:U()}))),e.Response=A.readonly(A.array(A.object({hash:U()})))})(fr||={});const pr=A.object({eoa:H(),executionData:U(),nonce:U(),signature:U()}),mr=A.object({...pr.shape,chainId:W()}),hr=A.object({address:H(),decimals:A.number(),feeToken:A.optional(A.boolean()),interop:A.optional(A.boolean()),nativeRate:A.optional(G()),symbol:A.string(),uid:A.string()}),gr=A.string().check(A.regex(/^[A-Z0-9]+$/)),_r=A.object({address:H(),chainId:W(),nonce:W()}),vr=A.object({..._r.shape,r:U(),s:U(),yParity:W()}),yr=A.object({data:A.optional(U()),to:H(),value:A.optional(G())});let br;(function(e){let t=e.Parameters=A.object({address:H(),secret:A.string()});e.Request=A.object({method:A.literal(`account_getOnrampContactInfo`),params:A.readonly(A.tuple([t]))}),e.Response=A.object({email:A.optional(A.string()),phone:A.optional(A.string()),phoneVerifiedAt:A.optional(A.number())})})(br||={});let xr;(function(e){let t=e.Parameters=A.object({address:H()});e.Request=A.object({method:A.literal(`account_onrampStatus`),params:A.readonly(A.tuple([t]))}),e.Response=A.object({email:A.optional(A.number()),phone:A.optional(A.number())})})(xr||={});let Sr;(function(e){let t=e.Parameters=A.object({phone:A.string(),walletAddress:H()});e.Request=A.object({method:A.literal(`account_resendVerifyPhone`),params:A.readonly(A.tuple([t]))}),e.Response=A.null()})(Sr||={});let Cr;(function(e){let t=e.Parameters=A.object({email:A.string().check(A.regex(/^.*@.*$/)),walletAddress:H()});e.Request=A.object({method:A.literal(`account_setEmail`),params:A.readonly(A.tuple([t]))}),e.Response=A.null()})(Cr||={});let wr;(function(e){let t=e.Parameters=A.object({phone:A.string(),walletAddress:H()});e.Request=A.object({method:A.literal(`account_setPhone`),params:A.readonly(A.tuple([t]))}),e.Response=A.null()})(wr||={});let Tr;(function(e){let t=e.Parameters=A.object({chainId:W(),email:A.string(),signature:U(),token:A.string(),walletAddress:H()});e.Request=A.object({method:A.literal(`account_verifyEmail`),params:A.readonly(A.tuple([t]))}),e.Response=A.null()})(Tr||={});let Er;(function(e){let t=e.Parameters=A.object({code:A.string(),phone:A.string(),walletAddress:H()});e.Request=A.object({method:A.literal(`account_verifyPhone`),params:A.readonly(A.tuple([t]))}),e.Response=A.null()})(Er||={});let Dr;(function(e){e.Request=A.object({method:A.literal(`health`),params:A.undefined()}),e.Response=A.object({quoteSigner:H(),status:A.string(),version:A.string()})})(Dr||={});let Or;(function(e){let t=e.Parameters=A.object({address:H(),chainId:W(),tokenAddress:H(),value:G()});e.Request=A.object({method:A.literal(`wallet_addFaucetFunds`),params:A.readonly(A.tuple([t]))}),e.Response=A.object({message:A.optional(A.string()),transactionHash:U()})})(Or||={});let kr;(function(e){let t=e.Parameters=A.object({chainId:W(),id:U()});e.Request=A.object({method:A.literal(`wallet_getAccounts`),params:A.readonly(A.tuple([t]))}),e.Response=A.readonly(A.array(A.object({address:H(),keys:cr.Response})))})(kr||={});let Ar;(function(e){let t=e.Parameters=A.object({address:H()});e.Request=A.object({method:A.literal(`wallet_getAuthorization`),params:A.readonly(A.tuple([t]))}),e.Response=A.object({authorization:vr,data:U(),to:H()})})(Ar||={});let jr;(function(e){e.Request=A.object({method:A.literal(`wallet_getCapabilities`),params:A.optional(A.tuple([A.readonly(A.array(A.number()))]))});let t=A.object({address:H(),version:A.optional(A.union([A.string(),A.null()]))});e.Response=A.record(U(),A.object({contracts:A.object({accountImplementation:t,accountProxy:t,legacyAccountImplementations:A.readonly(A.array(t)),legacyOrchestrators:A.readonly(A.array(A.union([A.object({orchestrator:t,simulator:t}),t]))),orchestrator:t,simulator:t}),fees:A.object({quoteConfig:A.object({constantRate:A.optional(A.union([A.number(),A.null()])),gas:A.optional(A.object({intentBuffer:A.optional(A.number()),txBuffer:A.optional(A.number())})),rateTtl:A.number(),ttl:A.number()}),recipient:H(),tokens:A.readonly(A.array(hr))})}))})(jr||={});let Mr;(function(e){let t=A.union([A.literal(`native`),A.literal(`erc20`),A.literal(`erc721`),A.string()]),n=e.Parameters=A.object({account:H(),assetFilter:A.optional(A.record(U(),A.readonly(A.array(A.object({address:A.union([H(),A.literal(`native`)]),type:t}))))),assetTypeFilter:A.optional(A.readonly(A.array(t))),chainFilter:A.optional(A.readonly(A.array(W())))});e.Request=A.object({method:A.literal(`wallet_getAssets`),params:A.readonly(A.tuple([n]))});let r=e.Price=A.object({currency:A.string(),value:A.codec(A.string(),A.number(),{decode:e=>Number(e),encode:e=>String(e)})});e.Response=A.record(A.string(),A.readonly(A.array(Gn([A.object({address:H(),balance:G(),metadata:A.nullable(A.object({decimals:A.number(),fiat:A.nullish(r),name:A.string(),symbol:A.string()})),type:A.literal(`erc20`)}),A.object({address:A.nullable(A.literal(`native`)),balance:G(),metadata:A.nullable(A.object({decimals:A.number(),fiat:A.nullish(r),name:A.optional(A.string()),symbol:A.optional(A.string())})),type:A.literal(`native`)})]))))})(Mr||={});let Nr;(function(e){e.Request=A.object({method:A.literal(`wallet_getCallsStatus`),params:A.readonly(A.tuple([U()]))}),e.Response=A.object({id:A.string(),receipts:A.optional(A.readonly(A.array(A.object({blockHash:U(),blockNumber:W(),chainId:W(),gasUsed:W(),logs:A.readonly(A.array(A.object({address:H(),data:U(),topics:A.readonly(A.array(U()))}))),status:U(),transactionHash:U()})))),status:A.number()})})(Nr||={});let Pr;(function(e){let t=e.Parameters=A.object({address:H(),chainIds:A.optional(A.readonly(A.array(W())))});e.Request=A.object({method:A.literal(`wallet_getKeys`),params:A.readonly(A.tuple([t]))}),e.Response=A.record(U(),cr.Response)})(Pr||={});let Fr;(function(e){let t=e.Capabilities=A.object({authorizeKeys:A.optional(cr.Request),meta:ur.Request,preCall:A.optional(A.boolean()),preCalls:A.optional(A.readonly(A.array(pr))),requiredFunds:A.optional(dr.Request),revokeKeys:A.optional(fr.Request)}),n=e.ResponseCapabilities=A.object({assetDiffs:A.optional(sr.Response),authorizeKeys:A.nullish(cr.Response),feePayerDigest:A.optional(U()),feeSignature:A.optional(U()),feeTotals:A.optional(lr.Response),revokeKeys:A.nullish(fr.Response)}),r=e.Parameters=A.object({calls:A.readonly(A.array(yr)),capabilities:t,chainId:W(),from:A.optional(H()),key:A.optional(A.object({prehash:A.boolean(),publicKey:U(),type:ar.shape.type}))});e.Request=A.object({method:A.literal(`wallet_prepareCalls`),params:A.readonly(A.tuple([r]))}),e.Response=A.object({capabilities:n,context:A.object({preCall:A.optional(A.partial(mr)),quote:A.optional(A.partial(tr))}),digest:U(),key:A.nullish(A.object({prehash:A.boolean(),publicKey:U(),type:ar.shape.type})),signature:U(),typedData:A.object({domain:A.union([A.object({chainId:A.union([W(),A.number()]),name:A.string(),verifyingContract:H(),version:A.string()}),A.object({})]),message:A.record(A.string(),A.unknown()),primaryType:A.string(),types:A.record(A.string(),A.unknown())})})})(Fr||={});let Ir;(function(e){let t=e.Capabilities=A.object({authorizeKeys:cr.Request}),n=e.Parameters=A.object({address:H(),capabilities:t,chainId:A.optional(A.number()),delegation:H()});e.Request=A.object({method:A.literal(`wallet_prepareUpgradeAccount`),params:A.readonly(A.tuple([n]))}),e.Response=A.object({capabilities:t,chainId:W(),context:A.object({address:H(),authorization:_r,chainId:W(),preCall:pr}),digests:A.object({auth:U(),exec:U()}),typedData:A.object({domain:A.union([A.object({chainId:A.union([W(),A.number()]),name:A.string(),verifyingContract:H(),version:A.string()}),A.object({})]),message:A.record(A.string(),A.unknown()),primaryType:A.string(),types:A.record(A.string(),A.unknown())})})})(Ir||={});let Lr;(function(e){e.Request=A.object({method:A.literal(`wallet_feeTokens`),params:A.optional(A.undefined())}),e.Response=A.record(U(),A.readonly(A.array(A.object({address:H(),decimals:A.number(),nativeRate:A.optional(G()),symbol:A.string()}))))})(Lr||={});let Rr;(function(e){let t=e.Parameters=A.object({capabilities:A.optional(A.object({feeSignature:A.optional(U())})),context:A.object({preCall:A.optional(A.partial(mr)),quote:A.optional(A.partial(tr))}),key:A.optional(A.object({prehash:A.boolean(),publicKey:U(),type:ar.shape.type})),signature:U()});e.Request=A.object({method:A.literal(`wallet_sendPreparedCalls`),params:A.readonly(A.tuple([t]))}),e.Response=A.object({id:U()})})(Rr||={});let zr;(function(e){let t=e.Parameters=A.object({context:A.object({address:H(),authorization:_r,chainId:W(),preCall:pr}),signatures:A.object({auth:U(),exec:U()})});e.Request=A.object({method:A.literal(`wallet_upgradeAccount`),params:A.readonly(A.tuple([t]))}),e.Response=A.undefined()})(zr||={});let Br;(function(e){let t=e.Parameters=A.object({address:U(),chainId:W(),digest:U(),signature:U()});e.Request=A.object({method:A.literal(`wallet_verifySignature`),params:A.readonly(A.tuple([t]))}),e.Response=A.object({proof:A.nullish(A.object({account:H(),initPreCall:A.nullish(pr),keyHash:U()})),valid:A.boolean()})})(Br||={});const K=A.object({chainId:A.optional(W()),expiry:W(),hash:U(),id:U(),prehash:A.optional(A.boolean()),publicKey:U(),role:A.union([A.literal(`admin`),A.literal(`session`)]),type:A.union([A.literal(`address`),A.literal(`p256`),A.literal(`secp256k1`),A.literal(`webauthn-p256`)])}),Vr=A.readonly(A.array(Gn([A.object({signature:A.string(),to:H()}),A.object({signature:A.string()}),A.object({to:H()})])).check(A.minLength(1))),Hr=A.object({limit:A.union([A.templateLiteral([A.number(),`.`,A.number()]),A.templateLiteral([A.number()])]).check(A.regex(/^\d+(\.\d+)?$/)),symbol:A.optional(A.union([A.literal(`native`),gr]))}),Ur=A.object({addresses:A.readonly(A.array(H()))}),Wr=A.readonly(A.array(A.object({limit:G(),period:A.union([A.literal(`minute`),A.literal(`hour`),A.literal(`day`),A.literal(`week`),A.literal(`month`),A.literal(`year`)]),token:A.optional(H())}))),Gr=A.object({calls:A.optional(Vr),signatureVerification:A.optional(Ur),spend:A.optional(Wr)}),Kr=A.object({...K.shape,feeToken:A.optional(A.nullable(Hr)),permissions:A.optional(Gr)}),qr=A.object({address:H(),chainId:A.optional(W()),expiry:A.number(),id:U(),key:A.pick(K,{publicKey:!0,type:!0}),permissions:A.object({calls:Vr,signatureVerification:A.optional(Ur),spend:A.optional(Wr)})}),Jr=A.object({address:A.optional(H()),chainId:A.optional(W()),expiry:A.number().check(A.gte(1)),feeToken:A.nullable(Hr),key:A.optional(A.pick(K,{publicKey:!0,type:!0})),permissions:A.object({calls:Vr,signatureVerification:A.optional(Ur),spend:A.optional(Wr)})});let Yr;(function(e){e.GetCapabilitiesResponse=A.object({status:A.union([A.literal(`supported`),A.literal(`unsupported`)])})})(Yr||={});let Xr;(function(e){e.Request=A.union([A.boolean(),A.object({chainId:A.optional(W()),label:A.optional(A.string())})])})(Xr||={});let Zr;(function(e){e.Request=Gn([A.object({chainId:A.optional(A.number()),domain:A.optional(A.string()),expirationTime:A.optional(A.date()),issuedAt:A.optional(A.date()),nonce:A.string(),notBefore:A.optional(A.date()),requestId:A.optional(A.string()),resources:A.optional(A.readonly(A.array(A.string()))),scheme:A.optional(A.string()),statement:A.optional(A.string()),uri:A.optional(A.string()),version:A.optional(A.literal(`1`))}),A.object({authUrl:A.union([A.string(),A.object({logout:A.string(),nonce:A.string(),verify:A.string()})]),chainId:A.optional(W()),domain:A.optional(A.string()),expirationTime:A.optional(A.date()),issuedAt:A.optional(A.date()),notBefore:A.optional(A.date()),requestId:A.optional(A.string()),resources:A.optional(A.readonly(A.array(A.string()))),scheme:A.optional(A.string()),statement:A.optional(A.string()),uri:A.optional(A.string()),version:A.optional(A.literal(`1`))})]),e.Response=A.object({message:A.string(),signature:U(),token:A.optional(A.string())})})(Zr||={});let q;(function(e){e.GetCapabilitiesResponse=A.object({supported:A.boolean(),tokens:A.readonly(A.array(hr))}),e.Request=A.union([gr,H()])})(q||={});let Qr;(function(e){e.Request=Jr})(Qr||={});let $r;(function(e){e.GetCapabilitiesResponse=A.object({supported:A.boolean()})})($r||={});let ei;(function(e){e.GetCapabilitiesResponse=A.object({supported:A.boolean()}),e.Request=A.object({id:A.optional(A.union([U(),A.null()]))}),e.Response=A.readonly(A.array(qr))})(ei||={});let ti;(function(e){e.Response=e.Request=A.readonly(A.array(A.object({context:A.unknown(),signature:U()})))})(ti||={});let ni;(function(e){e.Request=A.string()})(ni||={});let ri;(function(e){e.GetCapabilitiesResponse=A.object({supported:A.boolean(),tokens:A.readonly(A.array(hr))}),e.Request=A.readonly(A.array(Gn([A.object({address:H(),value:G()}),A.object({symbol:gr,value:A.union([A.templateLiteral([A.number(),`.`,A.number()]),A.templateLiteral([A.number()])]).check(A.regex(/^\d+(\.\d+)?$/))})])))})(ri||={});const ii=A.object({...A.pick(K,{id:!0,publicKey:!0,type:!0}).shape,credentialId:A.optional(A.string()),privateKey:A.optional(A.any())});let ai;(function(e){let t=e.Parameters=A.object({address:H(),secret:A.string()});e.Request=A.object({method:A.literal(`account_getOnrampContactInfo`),params:A.readonly(A.tuple([t]))}),e.Response=A.object({email:A.optional(A.string()),phone:A.optional(A.string()),phoneVerifiedAt:A.optional(A.number())})})(ai||={});let oi;(function(e){let t=e.Parameters=A.object({address:H()});e.Request=A.object({method:A.literal(`account_onrampStatus`),params:A.readonly(A.tuple([t]))}),e.Response=A.object({email:A.optional(A.number()),phone:A.optional(A.number())})})(oi||={});let si;(function(e){let t=e.Parameters=A.object({email:A.string(),walletAddress:H()});e.Request=A.object({method:A.literal(`account_resendVerifyPhone`),params:A.readonly(A.tuple([t]))}),e.Response=A.null()})(si||={});let ci;(function(e){let t=e.Parameters=A.object({email:A.string(),walletAddress:H()});e.Request=A.object({method:A.literal(`account_setEmail`),params:A.readonly(A.tuple([t]))}),e.Response=A.null()})(ci||={});let li;(function(e){let t=e.Parameters=A.object({email:A.string(),walletAddress:H()});e.Request=A.object({method:A.literal(`account_setPhone`),params:A.readonly(A.tuple([t]))}),e.Response=A.null()})(li||={});let ui;(function(e){let t=e.Parameters=A.object({chainId:W(),email:A.string(),token:A.string(),walletAddress:H()});e.Request=A.object({method:A.literal(`account_verifyEmail`),params:A.readonly(A.tuple([t]))}),e.Response=A.null()})(ui||={});let di;(function(e){let t=e.Parameters=A.object({code:A.string(),phone:A.string(),walletAddress:H()});e.Request=A.object({method:A.literal(`account_verifyPhone`),params:A.readonly(A.tuple([t]))}),e.Response=A.null()})(di||={});let fi;(function(e){let t=e.Parameters=A.object({address:A.optional(H()),chainId:A.optional(W()),token:A.optional(H()),value:A.optional(A.string())});e.Request=A.object({method:A.literal(`wallet_addFunds`),params:A.readonly(A.tuple([t]))}),e.Response=A.object({id:U()})})(fi||={});let pi;(function(e){e.Request=A.object({method:A.literal(`eth_accounts`),params:A.optional(A.unknown())}),e.Response=A.readonly(A.array(H()))})(pi||={});let mi;(function(e){e.Request=A.object({method:A.literal(`eth_chainId`),params:A.optional(A.unknown())}),e.Response=U()})(mi||={});let hi;(function(e){e.Request=A.object({method:A.literal(`eth_requestAccounts`),params:A.optional(A.unknown())}),e.Response=A.readonly(A.array(H()))})(hi||={});let gi;(function(e){e.Request=A.object({method:A.literal(`eth_sendTransaction`),params:A.readonly(A.tuple([A.object({capabilities:A.optional(A.object({feeToken:A.optional(q.Request),merchantUrl:A.optional(ni.Request),preCalls:A.optional(ti.Request)})),chainId:A.optional(W()),data:A.optional(U()),from:A.optional(H()),to:H(),value:A.optional(G())})]))}),e.Response=U()})(gi||={});let _i;(function(e){e.Request=A.object({method:A.literal(`eth_signTypedData_v4`),params:A.readonly(A.tuple([H(),A.string()]))}),e.Response=U()})(_i||={});let vi;(function(e){let t=e.Parameters=A.object({address:A.optional(H()),chainId:A.optional(W())});e.Request=A.object({method:A.literal(`wallet_getAdmins`),params:A.optional(A.readonly(A.tuple([t])))});let n=e.Key=ii;e.Response=A.object({address:H(),chainId:W(),keys:A.readonly(A.array(n))})})(vi||={});let yi;(function(e){let t=e.Capabilities=A.object({feeToken:A.optional(q.Request)}),n=e.Parameters=A.object({address:A.optional(H()),capabilities:A.optional(t),chainId:A.optional(W()),key:A.pick(K,{publicKey:!0,type:!0})});e.Request=A.object({method:A.literal(`wallet_grantAdmin`),params:A.readonly(A.tuple([n]))}),e.Response=A.object({address:H(),chainId:W(),key:vi.Key})})(yi||={});let bi;(function(e){let t=e.Parameters=Jr;e.Request=A.object({method:A.literal(`wallet_grantPermissions`),params:A.readonly(A.tuple([t]))}),e.ResponseCapabilities=A.object({preCalls:A.optional(ti.Response)}),e.Response=A.object({...qr.shape,capabilities:A.optional(A.any())})})(bi||={});let xi;(function(e){let t=e.Parameters=A.object({address:A.optional(H())});e.Request=A.object({method:A.literal(`wallet_getAccountVersion`),params:A.optional(A.readonly(A.tuple([t])))}),e.Response=A.object({current:A.string(),latest:A.string()})})(xi||={});let Si;(function(e){let t=e.Parameters=A.object({address:A.optional(H()),chainIds:A.optional(A.readonly(A.array(W())))});e.Request=A.object({method:A.literal(`wallet_getPermissions`),params:A.optional(A.readonly(A.tuple([t])))}),e.Response=ei.Response})(Si||={});let Ci;(function(e){let t=e.Capabilities=A.object({feeToken:A.optional(q.Request)}),n=e.Parameters=A.object({address:A.optional(H()),capabilities:A.optional(t),chainId:A.optional(W()),id:U()});e.Request=A.object({method:A.literal(`wallet_revokeAdmin`),params:A.readonly(A.tuple([n]))}),e.Response=void 0})(Ci||={});let wi;(function(e){let t=e.Capabilities=A.object({feeToken:A.optional(q.Request)}),n=e.Parameters=A.object({address:A.optional(H()),capabilities:A.optional(t),id:U()});e.Request=A.object({method:A.literal(`wallet_revokePermissions`),params:A.readonly(A.tuple([n]))}),e.Response=void 0})(wi||={});let Ti;(function(e){e.Request=A.object({method:A.literal(`wallet_switchEthereumChain`),params:A.readonly(A.tuple([A.object({chainId:U()})]))})})(Ti||={});let Ei;(function(e){let t=e.Parameters=A.object({context:A.unknown(),signatures:A.object({auth:U(),exec:U()})});e.Request=A.object({method:A.literal(`wallet_upgradeAccount`),params:A.readonly(A.tuple([t]))});let n=e.ResponseCapabilities=A.object({admins:A.optional(A.readonly(A.array(vi.Key))),permissions:A.optional(ei.Response)});e.Response=A.object({address:H(),capabilities:A.optional(n)})})(Ei||={});let Di;(function(e){e.Request=A.object({method:A.literal(`personal_sign`),params:A.readonly(A.tuple([U(),H()]))}),e.Response=U()})(Di||={});let Oi;(function(e){e.Request=A.object({method:A.literal(`porto_ping`),params:A.optional(A.undefined())}),e.Response=A.literal(`pong`)})(Oi||={});let ki;(function(e){let t=e.Capabilities=A.object({createAccount:A.optional(Xr.Request),email:A.optional(A.boolean()),grantAdmins:A.optional(A.readonly(A.array(A.pick(K,{publicKey:!0,type:!0})))),grantPermissions:A.optional(Qr.Request),preCalls:A.optional(ti.Request),selectAccount:A.optional(A.union([A.boolean(),A.object({address:H(),key:A.optional(A.object({credentialId:A.optional(A.string()),publicKey:U()}))})])),signInWithEthereum:A.optional(Zr.Request)}),n=e.Parameters=A.object({capabilities:A.optional(t),chainIds:A.optional(A.readonly(A.array(W())))});e.Request=A.object({method:A.literal(`wallet_connect`),params:A.optional(A.readonly(A.tuple([n])))});let r=e.ResponseCapabilities=A.object({admins:A.optional(A.readonly(A.array(A.object({...A.pick(K,{id:!0,publicKey:!0,type:!0}).shape,credentialId:A.optional(A.string())})))),permissions:A.optional(ei.Response),preCalls:A.optional(ti.Response),signInWithEthereum:A.optional(Zr.Response)});e.Response=A.object({accounts:A.readonly(A.array(A.object({address:H(),capabilities:A.optional(r)}))),chainIds:A.readonly(A.array(W()))})})(ki||={});let Ai;(function(e){e.Request=A.object({method:A.literal(`wallet_disconnect`),params:A.optional(A.unknown())}),e.Response=void 0})(Ai||={});let ji;(function(e){e.Parameters=Mr.Parameters,e.Request=Mr.Request,e.Response=Mr.Response})(ji||={});let Mi;(function(e){e.Request=A.object({method:A.literal(`wallet_getCallsStatus`),params:A.tuple([U()])}),e.Response=A.object({atomic:A.boolean(),chainId:W(),id:A.string(),receipts:A.optional(A.readonly(A.array(A.object({blockHash:U(),blockNumber:U(),gasUsed:U(),logs:A.readonly(A.array(A.object({address:H(),data:U(),topics:A.readonly(A.array(U()))}))),status:U(),transactionHash:U()})))),status:A.number(),version:A.string()})})(Mi||={});let Ni;(function(e){e.Request=A.object({method:A.literal(`wallet_getCapabilities`),params:A.optional(A.union([A.readonly(A.tuple([A.union([U(),A.undefined()])])),A.readonly(A.tuple([A.union([U(),A.undefined()]),A.readonly(A.array(W()))]))]))}),e.Response=A.record(U(),A.object({atomic:Yr.GetCapabilitiesResponse,feeToken:q.GetCapabilitiesResponse,merchant:$r.GetCapabilitiesResponse,permissions:ei.GetCapabilitiesResponse,requiredFunds:ri.GetCapabilitiesResponse}))})(Ni||={});let Pi;(function(e){let t=e.Parameters=A.object({address:H(),chainIds:A.optional(A.readonly(A.array(W())))});e.Request=A.object({method:A.literal(`wallet_getKeys`),params:A.readonly(A.tuple([t]))}),e.Response=A.readonly(A.array(Kr))})(Pi||={});let J;(function(e){let t=e.Capabilities=A.object({feeToken:A.optional(q.Request),merchantUrl:A.optional(ni.Request),permissions:A.optional(ei.Request),preCalls:A.optional(ti.Request),requiredFunds:A.optional(ri.Request)}),n=e.Parameters=A.object({calls:A.readonly(A.array(A.object({data:A.optional(U()),to:H(),value:A.optional(G())}))),capabilities:A.optional(t),chainId:A.optional(W()),from:A.optional(H()),key:A.optional(A.pick(K,{prehash:!0,publicKey:!0,type:!0})),version:A.optional(A.string())});e.Request=A.object({method:A.literal(`wallet_prepareCalls`),params:A.readonly(A.tuple([n]))}),e.Response=A.object({capabilities:A.optional(A.object({...Fr.ResponseCapabilities.shape,quote:A.optional(tr)})),chainId:U(),context:A.object({account:A.object({address:H()}),calls:n.shape.calls,nonce:G(),quote:A.optional(A.partial(tr))}),digest:U(),key:A.pick(K,{prehash:!0,publicKey:!0,type:!0}),typedData:A.object({domain:A.union([A.object({chainId:W(),name:A.string(),verifyingContract:H(),version:A.string()}),A.object({})]),message:A.record(A.string(),A.unknown()),primaryType:A.string(),types:A.record(A.string(),A.unknown())})})})(J||={});let Fi;(function(e){let t=e.Capabilities=A.object({...ki.Capabilities.shape,label:A.optional(A.string())}),n=e.Parameters=A.object({address:H(),capabilities:A.optional(t),chainId:A.optional(W())});e.Request=A.object({method:A.literal(`wallet_prepareUpgradeAccount`),params:A.readonly(A.tuple([n]))}),e.Response=A.object({context:A.unknown(),digests:A.object({auth:U(),exec:U()})})})(Fi||={});let Ii;(function(e){e.Capabilities=J.Capabilities,e.Request=A.object({method:A.literal(`wallet_sendCalls`),params:A.readonly(A.tuple([A.omit(J.Parameters,{key:!0})]))}),e.Response=A.object({id:U()})})(Ii||={});let Li;(function(e){let t=e.Parameters=A.object({capabilities:J.Response.shape.capabilities,chainId:U(),context:J.Response.shape.context,key:J.Response.shape.key,signature:U()});e.Request=A.object({method:A.literal(`wallet_sendPreparedCalls`),params:A.readonly(A.tuple([t]))}),e.Response=A.readonly(A.array(A.object({capabilities:A.optional(A.record(A.string(),A.unknown())),id:U()})))})(Li||={});let Ri;(function(e){let t=e.Parameters=A.object({address:H(),chainId:A.optional(W()),digest:U(),signature:U()});e.Request=A.object({method:A.literal(`wallet_verifySignature`),params:A.readonly(A.tuple([t]))}),e.Response=A.object({address:H(),chainId:W(),proof:A.optional(A.unknown()),valid:A.boolean()})})(Ri||={});function Y(e){let t=typeof e==`string`?{address:e}:e,n=t.sign?`privateKey`:`porto`,{address:r,sign:i,signMessage:a,signTransaction:o,signTypedData:s,type:c}=je({address:t.address,sign({hash:e}){if(n===`porto`)throw Error("`sign` not supported on porto accounts.");if(!t.sign)throw Error("`sign` not supported.");return t.sign({hash:e})},signMessage({message:e}){return this.sign({hash:v(e)})},signTransaction(){throw Error("`signTransaction` not supported on porto accounts.")},signTypedData(e){return this.sign({hash:y(e)})}});return{address:r,keys:t.keys??void 0,sign:i,signMessage:a,signTransaction:o,signTypedData:s,source:n,type:c}}function zi(e,t={}){let{keys:n}=t;return Y({address:T.fromPublicKey(k.getPublicKey({privateKey:e})),keys:n,async sign({hash:t}){return Te.toHex(k.sign({payload:t,privateKey:e}))},source:`privateKey`})}function Bi(e,t={}){let{key:n,role:r}=t;if(n!==null){if(typeof n==`object`)return n;if(e.keys&&e.keys.length>0)return typeof n==`number`?e.keys[n]:e.keys.find(e=>e.privateKey&&(!r||e.role===r))}}async function Vi(e,t){let{storage:n,replaySafe:r=!0,wrap:i=!0,webAuthn:a}=t,o=Bi(e,t),s=(()=>r?Ee.getSignPayload({domain:{verifyingContract:e.address},message:{digest:t.payload},primaryType:`ERC1271Sign`,types:{ERC1271Sign:[{name:`digest`,type:`bytes32`}]}}):t.payload)(),c=(()=>o?({hash:e})=>V(o,{address:null,payload:e,storage:n,webAuthn:a,wrap:i}):e.source===`privateKey`?e.sign:void 0)();if(!c)throw Error(`cannot find key to sign with.`);return await c({hash:s})}async function Hi(e,t={}){let{chainIds:n,...r}=t,i=await e.request({method:`wallet_connect`,params:[A.encode(ki.Parameters,{capabilities:r,chainIds:n})]});return A.decode(ki.Response,i)}const Ui=()=>`IntersectionObserver`in window&&`IntersectionObserverEntry`in window&&`intersectionRatio`in IntersectionObserverEntry.prototype&&`isVisible`in IntersectionObserverEntry.prototype;function Wi(e={}){let{prefix:t=`[Porto]`}=e,n=new Set;return{error:Ki(console.error,{prefix:t}),errorOnce:Ki(console.error,{memo:n,prefix:t}),log:Ki(console.log,{prefix:t}),logOnce:Ki(console.log,{memo:n,prefix:t}),warn:Ki(console.warn,{prefix:t}),warnOnce:Ki(console.warn,{memo:n,prefix:t})}}const Gi=Wi();function Ki(e,t={}){let{memo:n,prefix:r}=t;return(...t)=>{let i=t.join(` `);n?.has(i)||(n?.add(i),e(`${r} ${i}`))}}function qi(){let e=navigator.userAgent.toLowerCase();return e.includes(`safari`)&&!e.includes(`chrome`)}function Ji(){let e=navigator.userAgent.toLowerCase();return(e.includes(`firefox`)||e.includes(`fxios`))&&!e.includes(`seamonkey`)}function Yi(){return window.navigator?.userAgentData?.mobile?!0:navigator.maxTouchPoints>1||/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(navigator.userAgent.slice(0,4))}function Xi(){let e=()=>void 0,t=()=>void 0;return{promise:new Promise((n,r)=>{e=n,t=r}),reject:t,resolve:e}}function Zi(e){if(Array.isArray(e))return e.map(Zi);if(typeof e==`function`)return;if(typeof e!=`object`||!e)return e;if(Object.getPrototypeOf(e)!==Object.prototype)try{return structuredClone(e)}catch{return}let t={};for(let[n,r]of Object.entries(e))t[n]=Zi(r);return t}function Qi(e,t){let n=[],r=new Set;for(let i of e){let e=t(i);r.has(e)||(r.add(e),n.push(i))}return n}function $i(){return typeof globalThis<`u`&&`crypto`in globalThis?globalThis.crypto.randomUUID():crypto.randomUUID()}function ea(e,{enabled:t=!0,id:n}){if(!t||!n)return e();if(ea.cache.get(n))return ea.cache.get(n);let r=e().finally(()=>ea.cache.delete(n));return ea.cache.set(n,r),r}(function(e){e.cache=new Map})(ea||={});function ta(e){return e}function na(e,t={}){let{targetOrigin:n}=t,r=new Map;return ta({destroy(){for(let t of r.values())e.removeEventListener(`message`,t)},on(t,i,a){function o(e){e.data.topic===t&&(a&&e.data.id!==a||n&&e.origin!==n||i(e.data.payload,e))}return e.addEventListener(`message`,o),r.set(t,o),()=>e.removeEventListener(`message`,o)},async send(t,r,i){let a=$i();return e.postMessage(Zi({id:a,payload:r,topic:t}),i??n??`*`),{id:a,payload:r,topic:t}},async sendAsync(e,t,n){let{id:r}=await this.send(e,t,n);return new Promise(t=>this.on(e,t,r))}})}function ra(e){let{from:t,to:n,waitForReady:r=!1}=e,i=!1,a=Xi();t.on(`ready`,a.resolve);let o=ta({destroy(){t.destroy(),n.destroy(),i&&a.reject()},on(e,n,r){return t.on(e,n,r)},async send(e,t){return i=!0,r&&await a.promise.finally(()=>i=!1),n.send(e,t)},async sendAsync(e,t){return i=!0,r&&await a.promise.finally(()=>i=!1),n.sendAsync(e,t)}});return{...o,ready(e){o.send(`ready`,e)},waitForReady(){return a.promise}}}const ia={local:`http://localhost:5175/dialog/`,prod:`https://id.porto.sh/dialog`,stg:`https://stg.id.porto.sh/dialog`};function aa(e){return e}function oa(e={}){let{skipProtocolCheck:t,skipUnsupported:n}=e,r=e=>!n&&qi()&&e?.some(e=>[`wallet_connect`,`eth_requestAccounts`].includes(e.method));return typeof window>`u`?ca():aa({name:`iframe`,setup(e){let{host:n,internal:i,theme:a,themeController:o}=e,{store:s}=i,c=sa().setup(e),l=!1,u=new URL(n),d=document.createElement(`dialog`);d.dataset.porto=``,d.setAttribute(`role`,`dialog`),d.setAttribute(`aria-closed`,`true`),d.setAttribute(`aria-label`,`Porto Wallet`),d.setAttribute(`hidden`,`until-found`),Object.assign(d.style,{background:`transparent`,border:`0`,outline:`0`,padding:`0`,position:`fixed`}),document.body.appendChild(d);let f=document.createElement(`iframe`);f.setAttribute(`data-testid`,`porto`);let p=[`payment`,`publickey-credentials-get ${u.origin}`,`publickey-credentials-create ${u.origin}`];Ji()||p.push(`clipboard-write`),f.setAttribute(`allow`,p.join(`; `)),f.setAttribute(`tabindex`,`0`),f.setAttribute(`sandbox`,`allow-forms allow-scripts allow-same-origin allow-popups allow-popups-to-escape-sandbox`),f.setAttribute(`src`,ma(n)),f.setAttribute(`title`,`Porto`),Object.assign(f.style,{backgroundColor:`transparent`,border:`0`,colorScheme:`light dark`,height:`100%`,left:`0`,position:`fixed`,top:`0`,width:`100%`});let m=document.createElement(`style`);m.innerHTML=`
        dialog[data-porto]::backdrop {
          background: transparent!important;
        }
      `,d.appendChild(m),d.appendChild(f);let h=ra({from:na(window,{targetOrigin:u.origin}),to:na(f.contentWindow,{targetOrigin:u.origin}),waitForReady:!0});o?._setup(h,!0);let g=window.matchMedia(`(max-width: 460px)`),_=()=>{h.send(`__internal`,{type:`resize`,width:g.matches?460:461})};g.addEventListener(`change`,_),h.on(`ready`,t=>{let n=e.internal.store.getState().chainIds.filter(e=>t.chainIds.includes(e));n.length===0&&(n=t.chainIds),s.setState(e=>({...e,chainIds:n})),h.send(`__internal`,{chainIds:n,mode:`iframe`,referrer:da(),theme:a,type:`init`}),_()}),h.on(`rpc-response`,e=>{r([e._request])&&(f.src=f.src),pa(s,e)}),h.on(`__internal`,e=>{e.type===`switch`&&e.mode===`popup`&&(c.open(),c.syncRequests(s.getState().requestQueue))});let v=null,y=null,b=()=>fa(s),ee=e=>{e.key===`Escape`&&fa(s)},x=new MutationObserver(e=>{for(let t of e){if(t.type!==`attributes`)continue;let e=t.attributeName;e&&e===`inert`&&d.removeAttribute(e)}});x.observe(d,{attributeOldValue:!0,attributes:!0});let S=!1,te=()=>{S&&(S=!1,d.removeEventListener(`click`,b),document.removeEventListener(`keydown`,ee),d.style.pointerEvents=`none`,y?.focus(),y=null,Object.assign(document.body.style,v??``),document.body.style.overflow=v?.overflow??``)},ne=()=>{S||(S=!0,d.addEventListener(`click`,b),document.addEventListener(`keydown`,ee),f.focus(),d.style.pointerEvents=`auto`,v=Object.assign({},document.body.style),document.body.style.overflow=`hidden`)},C=!1,w=()=>{C||(C=!0,document.activeElement instanceof HTMLElement&&(y=document.activeElement),d.removeAttribute(`hidden`),d.removeAttribute(`aria-closed`),d.showModal())},re=()=>{if(C){C=!1,d.setAttribute(`hidden`,`true`),d.setAttribute(`aria-closed`,`true`),d.close();for(let e of d.parentNode?Array.from(d.parentNode.children):[])e!==d&&e.hasAttribute(`inert`)&&e.removeAttribute(`inert`)}};return{close(){c.close(),l=!1,h.send(`__internal`,{mode:`iframe`,referrer:da(),type:`init`}),re(),te()},destroy(){c.close(),l=!1,te(),re(),c.destroy(),h.destroy(),d.remove(),x.disconnect(),g.removeEventListener(`change`,_)},open(){l||(l=!0,w(),ne(),h.send(`__internal`,{mode:`iframe`,referrer:da(),type:`init`}))},async secure(){let{trustedHosts:e}=await h.waitForReady(),n=(()=>{if(t)return!0;let e=window.location.protocol.startsWith(`https`);return e||Gi.warnOnce(`Detected insecure protocol (HTTP).`,`\n\nThe Porto iframe is not supported on HTTP origins (${window.location.origin})`,`due to lack of WebAuthn support.`,`See https://porto.sh/sdk#secure-origins-https for more information.`),e})(),r=Ui(),i=!!e?.includes(window.location.hostname),a=!!(r||i);return a||Gi.warnOnce([`Warning: Browser does not support IntersectionObserver v2 or host "${u.hostname}" is not trusted by Porto.`,`This may result in the dialog falling back to a popup.`,``,`Add "${u.hostname}" to the trusted hosts list to enable iframe dialog: https://github.com/ithacaxyz/porto/edit/main/src/trusted-hosts.ts`].join(`
`)),{frame:a,host:i,protocol:n}},async syncRequests(e){let{methodPolicies:t}=await h.waitForReady(),n=await this.secure(),i=e?.every(e=>t?.find(t=>t.method===e.request.method)?.modes?.headless===!0),a=r(e.map(e=>e.request));if(!i&&(a||!n.protocol||!n.frame))c.syncRequests(e);else{let n=e.some(e=>ua(e.request,{methodPolicies:t,targetOrigin:u.origin}));!l&&n&&this.open(),h.send(`rpc-requests`,e)}}}},supportsHeadless:!0})}function sa(e={}){if(typeof window>`u`)return ca();let{type:t=`auto`,size:n=la}=e;return aa({name:`popup`,setup(e){let{host:r,internal:i,themeController:a}=e,{store:o}=i,s=new URL(r),c=null,l=t===`page`||t===`auto`&&Yi()?`page`:`popup`;function u(){c&&fa(o)}let d=(()=>{let e=setInterval(()=>{c?.closed&&fa(o)},100);return()=>clearInterval(e)})(),f;return a?._setup(null,!0),{close(){c&&=(c.close(),null)},destroy(){this.close(),window.removeEventListener(`focus`,u),f?.destroy(),d()},open(){if(l===`popup`){let e=(window.innerWidth-n.width)/2+window.screenX,t=window.screenY+100;c=window.open(ma(r),`_blank`,`width=${n.width},height=${n.height},left=${e},top=${t}`)}else c=window.open(ma(r),`_blank`);if(!c)throw Error(`Failed to open popup`);f=ra({from:na(window,{targetOrigin:s.origin}),to:na(c,{targetOrigin:s.origin}),waitForReady:!0}),a?._setup(f,!1),f.send(`__internal`,{mode:l===`page`?`page`:`popup`,referrer:da(),theme:a?.getTheme()??e.theme,type:`init`}),f.on(`rpc-response`,e=>pa(o,e)),window.removeEventListener(`focus`,u),window.addEventListener(`focus`,u)},async secure(){return{frame:!0,host:!0,protocol:!0}},async syncRequests(e){e.some(e=>ua(e.request))&&((!c||c.closed)&&this.open(),c?.focus()),f?.send(`rpc-requests`,e)}}},supportsHeadless:!1})}function ca(){return aa({name:`noop`,setup(){return{close(){},destroy(){},open(){},async secure(){return{frame:!0,host:!0,protocol:!0}},async syncRequests(){}}},supportsHeadless:!0})}const la={height:282,width:360};function ua(e,t={}){let{methodPolicies:n,targetOrigin:r}=t,i=n?.find(t=>t.method===e.method);return i&&i.modes?.headless?!!(typeof i.modes.headless==`object`&&i.modes.headless.sameOrigin&&r!==window.location.origin):!0}function da(){return{icon:(()=>{let e=document.querySelector(`link[rel="icon"][media="(prefers-color-scheme: dark)"]`)?.href,t=document.querySelector(`link[rel="icon"][media="(prefers-color-scheme: light)"]`)?.href??document.querySelector(`link[rel="icon"]`)?.href;return e&&t&&e!==t?{dark:e,light:t}:window.matchMedia(`(prefers-color-scheme: dark)`).matches?e:t})(),title:document.title}}function fa(e){e.setState(e=>({...e,requestQueue:e.requestQueue.map(e=>({account:e.account,error:new M.UserRejectedRequestError,request:e.request,status:`error`}))}))}function pa(e,t){e.setState(e=>({...e,requestQueue:e.requestQueue.map(e=>e.request.id===t.id?t.error?{account:e.account,error:t.error,request:e.request,status:`error`}:{account:e.account,request:e.request,result:t.result,status:`success`}:e)}))}function ma(e){let t=new URL(e),n=new URLSearchParams(window.location.search);for(let[e,r]of n.entries())e.startsWith(`porto.`)&&t.searchParams.set(e.slice(6),r);return t.toString()}function ha(e){let t=Pe.createServer(e);return new Promise((e,n)=>{t.on(`error`,n),t.listen(()=>{let{port:n}=t.address();e(Object.assign(t,{closeAsync(){return new Promise((e,n)=>t.close(t=>t?n(t):e(void 0)))},url:`http://localhost:${n}`}))})})}async function ga(){let e=new Map,t=new Set,n=new Set,r=await ha((r,i)=>{let a=Me.parse(r.url,!0);if(i.setHeader(`Access-Control-Allow-Origin`,`*`),i.setHeader(`Access-Control-Allow-Methods`,`GET, POST, OPTIONS`),i.setHeader(`Access-Control-Allow-Headers`,`Content-Type`),i.setHeader(`Access-Control-Allow-Private-Network`,`true`),r.method===`OPTIONS`){i.writeHead(200),i.end();return}if(r.method===`GET`&&a.pathname===`/`){i.writeHead(200,{"Access-Control-Allow-Origin":`*`,"Cache-Control":`no-cache`,Connection:`keep-alive`,"Content-Type":`text/event-stream`}),t.add(i),r.on(`close`,()=>t.delete(i));return}if(r.method===`POST`&&a.pathname===`/`){let t=``;r.on(`data`,e=>t+=e.toString()),r.on(`end`,()=>{try{let n=JSON.parse(t);if(n.topic&&n.payload!==void 0){let t=e.get(n.topic);if(t){let e={data:n,origin:`http://localhost`};for(let r of t)r(n.payload,e)}}i.writeHead(200,{"Content-Type":`text/plain`}),i.end(`ok`)}catch{i.writeHead(400,{"Content-Type":`text/plain`}),i.end(`Invalid JSON`)}})}else r.method===`GET`&&a.pathname===`/.well-known/keys`?(i.writeHead(200,{"Access-Control-Allow-Origin":`*`,"Content-Type":`application/json`}),i.end(JSON.stringify({keys:Array.from(n)}))):(i.writeHead(404,{"Content-Type":`text/plain`}),i.end(`not found`))}),i=r.url,a=Xi(),o={destroy(){e.clear();for(let e of t)try{e.end()}catch{}t.clear(),r.close()},on(t,n){return e.has(t)||e.set(t,new Set),e.get(t).add(n),()=>{let r=e.get(t);r&&(r.delete(n),r.size===0&&e.delete(t))}},registerPublicKey(e){n.add(e)},relayUrl:i,async send(e,n){let r=$i(),i={id:r,payload:n,topic:e},a=`data: ${Ne.stringify(i)}\n\n`;for(let e of t)try{e.write(a)}catch{t.delete(e)}return{id:r,payload:n,topic:e}},async sendAsync(){throw Error(`Not implemented`)},waitForReady(){return o.on(`ready`,a.resolve),a.promise}};return o}const X=await ga();async function _a(){let e=!1;return aa({name:`cli`,setup(t){return X.on(`rpc-response`,e=>{pa(t.internal.store,e)}),X.on(`ready`,()=>{let{store:e}=t.internal,n=e.getState().requestQueue.map(e=>e.status===`pending`?e:void 0).filter(Boolean);X.send(`rpc-requests`,n)}),{close(){},destroy(){X.destroy()},open(){let n=new URLSearchParams([[`relayUrl`,X.relayUrl]]),r=t.host.replace(/\/$/,``)+`/?`+n.toString();console.log(`

Open the URL below in your browser to continue:`),console.log(`\n${r}\n`),e=!0},async secure(){return{frame:!0,host:!0,protocol:!0}},async syncRequests(t){if(t.length>1)throw Error("renderer (`cli`) does not support multiple requests.");t[0]?.request&&(e||this.open(),await X.waitForReady(),X.send(`rpc-requests`,t))}}},supportsHeadless:!0})}function va(e){return{...e,setup:e.setup??(()=>()=>{})}}async function ya(e){let{account:t,calls:n,permissionsId:r}=e;if(r!==void 0){if(r===null)return;let e=t.keys?.find(e=>e.publicKey===r&&e.privateKey);if(!e)throw Error(`permission (id: ${r}) does not exist.`);return e}let i=t.keys?.find(e=>!e.privateKey||e.role!==`session`||e.expiry<BigInt(Math.floor(Date.now()/1e3))?!1:!!n.every(t=>e.permissions?.calls?.some(e=>{if(e.to&&e.to!==t.to)return!1;if(e.signature){if(!t.data)return!1;let n=D.slice(t.data,0,4);if(D.validate(e.signature))return e.signature===n;if(Fe.getSelector(e.signature)!==n)return!1}return!0}))),a=t.keys?.find(e=>e.role===`admin`&&e.privateKey);return i??a}const ba=qr;function xa(e,t){let{chainId:n,expiry:r,permissions:i,id:a,publicKey:o,type:s}=e,{address:c}=t;return{address:c,chainId:n,expiry:r,id:a,key:{publicKey:o,type:s},permissions:i??{}}}function Sa(e){let{chainId:t,expiry:n,key:r}=e;return B({chainId:t,expiry:n,permissions:e.permissions??{},publicKey:r.publicKey,role:`session`,type:r.type})}const Ca=Jr;function wa(e){let{expiry:t,feeToken:n,permissions:r,publicKey:i,type:a}=e;return{expiry:t,feeToken:n??null,key:{publicKey:i,type:a},permissions:r??{}}}async function Z(e,t={}){if(!e)return;let n={chainId:t.chainId??e.chainId,expiry:e.expiry??0,feeToken:e.feeToken,permissions:Vn(e,{feeTokens:t.feeTokens}),role:`session`};if(e?.key)return B({...n,publicKey:e.key.publicKey,type:e.key.type??`secp256k1`});if(typeof globalThis.crypto?.subtle?.generateKey==`function`)try{return await jn(n)}catch(e){if(!Ta(e))throw e}return Dn(n)}function Ta(e){if(!(e instanceof Error))return!1;let t=e.message?.toLowerCase()??``;return e.name===`TypeError`||e.name===`ReferenceError`||t.includes(`subtle`)||t.includes(`generatekey`)}async function Ea(e){let{address:t,authUrl:n,message:r,signature:i,publicKey:a}=e,{chainId:o}=ze.parseMessage(r);return await fetch(n.verify,{body:JSON.stringify({address:t,chainId:o,message:r,signature:i,walletAddress:t,...a&&{publicKey:a}}),credentials:`include`,headers:{"Content-Type":`application/json`},method:`POST`}).then(e=>e.json())}async function Da(e,t,n){let{chainId:r=e.chain?.id,domain:i,uri:a,resources:o,version:s=`1`}=t,{address:c}=n,l=t.authUrl?Oa(t.authUrl):void 0;if(!r)throw Error("`chainId` is required.");if(!i)throw Error("`domain` is required.");if(!t.nonce&&!l?.nonce)throw Error("`nonce` or `authUrl.nonce` is required.");if(!a)throw Error("`uri` is required.");let u=await(async()=>{if(t.nonce)return t.nonce;if(!l?.nonce)throw Error("`nonce` or `authUrl.nonce` is required.");let e=await(await fetch(l.nonce,{body:JSON.stringify({address:c,chainId:r,walletAddress:c}),headers:{"Content-Type":`application/json`},method:`POST`})).json().catch(()=>void 0);if(!e?.nonce)throw Error("`nonce` or `authUrl.nonce` is required.");return e.nonce})();return ze.createMessage({...t,address:n.address,chainId:r,domain:i,nonce:u,resources:o,uri:a,version:s})}function Oa(e,t=``){if(!e)return;let n=(()=>{if(typeof e==`string`){let t=e.replace(/\/$/,``);return{logout:t+`/logout`,nonce:t+`/nonce`,verify:t+`/verify`}}return e})();return{logout:ka(n.logout,t),nonce:ka(n.nonce,t),verify:ka(n.verify,t)}}function ka(e,t){return!t||!e.startsWith(`/`)?e:t+e}async function Aa(e,t){let{account:n=e.account}=t,r=n?Y(n):void 0;if(!r)throw Error(`account is required.`);let{domain:{name:i,version:a}}=await ne(e,{address:r.address});if(!e.chain)throw Error(`client.chain is required`);return{chainId:e.chain.id,name:i,verifyingContract:r.address,version:a}}async function ja(e,t){try{let n=`wallet_getAuthorization`,r=await x(()=>e.request({method:n,params:[A.encode(Ar.Parameters,t)]}),{cacheKey:`${e.uid}.${n}.${t.address}`});return A.decode(Ar.Response,r)}catch(e){throw Q(e),e}}async function Ma(e,t={}){let n=(()=>{if(t.chainId)return[t.chainId];if(t.chainIds!==`all`)return t.chainIds?t.chainIds:[e.chain.id]})();try{let r=`wallet_getCapabilities`,i=await x(()=>e.request({method:r,params:n?[n]:void 0},{retryCount:0}),{cacheKey:`${e.uid}.${r}.${n?.join(`,`)}`}),a=(()=>t.raw?i:A.decode(jr.Response,i))();return t.chainIds?a:Object.values(a)[0]}catch(e){throw Q(e),e}}async function Na(e,t){let{account:n,assetFilter:r,assetTypeFilter:i,chainFilter:a}=t;try{let t=await e.request({method:`wallet_getAssets`,params:[A.encode(Mr.Parameters,{account:n,assetFilter:r,assetTypeFilter:i,chainFilter:a})]}),o=A.decode(Mr.Response,t),s=Object.entries(o).reduce((e,[t,n])=>(e[D.toNumber(t)]=n,e),{}),c={};for(let e of Object.values(s))for(let t of e){let e=JSON.stringify(t.metadata);c[e]={...t,balance:t.balance+(c[e]?.balance??0n)}}return{...s,0:Object.values(c)}}catch(e){throw Q(e),e}}async function Pa(e,t){let{id:n}=t;try{let t=await e.request({method:`wallet_getCallsStatus`,params:[n]});return A.decode(Nr.Response,t)}catch(e){throw Q(e),e}}async function Fa(e,t){let{address:n,chainIds:r}=t;try{let t=await e.request({method:`wallet_getKeys`,params:[A.encode(Pr.Parameters,{address:n,chainIds:r})]});return A.decode(Pr.Response,t)}catch(e){throw Q(e),e}}async function Ia(e){let t=`health`,n=await x(()=>e.request({method:t}),{cacheKey:`${e.uid}.${t}`});return A.decode(Dr.Response,n)}async function La(e,t){let{address:n,capabilities:r,chain:i=e.chain,key:a}=t,o=t.calls.map(e=>({data:e.abi?be.encodeData(be.fromAbi(e.abi,e.functionName),e.args):e.data??`0x`,to:e.to,value:e.value??0n}));try{let t=await e.request({method:`wallet_prepareCalls`,params:[A.encode(Fr.Parameters,{calls:o,capabilities:{...r,meta:{...r?.meta}},chainId:i?.id,from:n,key:a?{prehash:a.prehash,publicKey:a.publicKey,type:a.type}:void 0})]},{retryCount:0});return Object.assign(A.decode(Fr.Response,t),{_raw:t})}catch(e){throw Q(e),Ga(e,{calls:t.calls}),e}}async function Ra(e,t){let{address:n,chain:r=e.chain,delegation:i,...a}=t;try{let t=await e.request({method:`wallet_prepareUpgradeAccount`,params:[A.encode(Ir.Parameters,Zi({address:n,capabilities:a,chainId:r?.id,delegation:i}))]},{retryCount:0});return A.decode(Ir.Response,t)}catch(e){throw Q(e),Ga(e),e}}async function za(e,t){let{capabilities:n,context:r,key:i,signature:a}=t;try{let t=await e.request({method:`wallet_sendPreparedCalls`,params:[A.encode(Rr.Parameters,{capabilities:n,context:{preCall:r.preCall,quote:r.quote},key:i?{prehash:i.prehash,publicKey:i.publicKey,type:i.type}:void 0,signature:a})]},{retryCount:0});return A.decode(Rr.Response,t)}catch(e){throw Q(e),Ga(e),e}}async function Ba(e,t){let{email:n,walletAddress:r}=t;try{let t=await e.request({method:`account_setEmail`,params:[A.encode(Cr.Parameters,{email:n,walletAddress:r})]},{retryCount:0});return A.decode(Cr.Response,t)}catch(e){throw Q(e),Ga(e),e}}async function Va(e,t){let{context:n,signatures:r}=t;try{await e.request({method:`wallet_upgradeAccount`,params:[A.encode(zr.Parameters,{context:n,signatures:r})]},{retryCount:0})}catch(e){throw Q(e),Ga(e),e}}async function Ha(e,t){let{chainId:n,email:r,signature:i,token:a,walletAddress:o}=t;try{let t=await e.request({method:`account_verifyEmail`,params:[A.encode(Tr.Parameters,{chainId:n,email:r,signature:i,token:a,walletAddress:o})]},{retryCount:0});return A.decode(Tr.Response,t)}catch(e){throw Q(e),Ga(e),e}}async function Ua(e,t){let{signature:n}=t,{signature:r,capabilities:{feeSignature:i,...a},...o}=t.response,s=Ka({capabilities:a,...o}),c=Se.keccak256(D.fromString(JSON.stringify(s))),l=k.recoverAddress({payload:c,signature:Te.fromHex(n)}),{quoteSigner:u}=await Ia(e);return l===u}async function Wa(e,t){let{address:n,chain:r=e.chain,digest:i,signature:a}=t;try{async function t(){return{proof:null,valid:await C(e,{address:n,hash:i,signature:a})}}let o=await(async()=>{let o=await e.request({method:`wallet_verifySignature`,params:[A.encode(Br.Parameters,{address:n,chainId:r?.id,digest:i,signature:a})]},{retryCount:0}).catch(t);return o.valid?o:t()})();return A.decode(Br.Response,o)}catch(e){throw Q(e),e}}function Ga(e,{calls:t}={}){if(!(e instanceof d))return;let n=e=>{try{if(e.name===`ContractFunctionExecutionError`){let t=e.cause.name===`ContractFunctionRevertedError`?e.cause.data:void 0;if(t)return Ve.fromAbi([t.abiItem],t.errorName)}let t=e.walk(e=>!(e instanceof Error)&&e.code===3);if(!t)return;let{data:n,message:r}=t;return n===`0xd0d5039b`?Ve.from(`error Unauthorized()`):{inputs:[],name:(r??n).split(`(`)[0],type:`error`}}catch{return}},r=He(e,{calls:t??[]}),i=n(r);if(!(r===e&&!i))throw new qa(Object.assign(r,{abiError:i}))}function Ka(e){if(typeof e==`object`&&e){if(Array.isArray(e))return e.map(Ka);let t={};for(let n of Object.keys(e).sort())t[n]=Ka(e[n]);return t}return e}function Q(e){if(e.name===`$ZodError`)throw qn(e)}var qa=class extends Ae.BaseError{constructor(e){super(`An error occurred while executing calls.`,{cause:e,metaMessages:[e.abiError&&`Reason: `+e.abiError.name].filter(Boolean)}),this.name=`Rpc.ExecutionError`,this.abiError=e.abiError}};async function Ja(e,t){let{account:n=e.account,chainIds:r}=t,i=n?Y(n):void 0;if(!i)throw Error(`account is required.`);let a=await Fa(e,{address:i.address,chainIds:r});return Object.entries(a).flatMap(([e,t])=>t.map(t=>Nn(t,{chainId:Number(e)})))}async function Ya(e,t){let{account:n=e.account,calls:r,chain:i=e.chain,feePayer:a,merchantUrl:o,nonce:s,preCalls:c,requiredFunds:l,revokeKeys:u}=t,d=n?Y(n):void 0,p=t.key??(d?Bi(d,{role:`admin`}):void 0),m=t.authorizeKeys?.some(e=>e.role===`session`),{contracts:h,fees:{tokens:g}}=await Ma(e,{chainId:i?.id}),_=m?h.orchestrator.address:void 0,v=(t.authorizeKeys??[]).map(e=>Bn(e,{feeTokens:g,orchestrator:_})),y=(()=>t.feeToken?t.feeToken:p?.permissions?.spend?.[0]?.token)(),ee=typeof c==`boolean`?c:!1,x=typeof c==`object`?c.map(({context:e,signature:t})=>({...e.preCall,signature:t})):void 0,S={address:d?.address,calls:r??[],capabilities:{authorizeKeys:v,meta:{feePayer:a,feeToken:y,nonce:s},preCall:ee,preCalls:x,requiredFunds:l,revokeKeys:u?.map(e=>({hash:e.hash}))},chain:i,key:p?Bn(p,{feeTokens:g}):void 0},te=await(async()=>o?await La(f({chain:e.chain,transport:b(o)}),S).catch(t=>(console.error(t),La(e,S))):await La(e,S))(),{capabilities:ne,context:C,digest:w,signature:re,typedData:ie}=te;if(o&&!await Ua(e,{response:te._raw,signature:re}))throw Error(`cannot verify integrity of \`wallet_prepareCalls\` response from ${o}`);return{capabilities:{...ne,quote:C.quote},context:C,digest:w,key:p,typedData:ie}}async function Xa(e,t){let{address:n,authorizeKeys:r,chain:i=e.chain}=t;if(!i)throw Error(`chain is required.`);let{contracts:a,fees:{tokens:o}}=await Ma(e,{chainId:i.id}),s=t.delegation??a.accountProxy.address,c=r.some(e=>e.role===`session`)?a.orchestrator.address:void 0,{capabilities:l,chainId:u,context:d,digests:f,typedData:p}=await Ra(e,{address:n,authorizeKeys:r.map(e=>{let t=e.role===`session`?e.permissions:{};return Bn({...e,permissions:t},{feeTokens:o,orchestrator:c})}),chain:i,delegation:s}),m=Y({address:n,keys:r});return{capabilities:l,chainId:u,context:{...d,account:m},digests:f,typedData:p}}async function Za(e,t){let{account:n=e.account,chain:r=e.chain,webAuthn:i}=t;if(!r)throw Error("`chain` is required.");let a=n?Y(n):void 0;if(!a)throw Error("`account` is required.");let o=t.key??Bi(a,t);if(!o&&!a.sign)throw Error("`key` or `account` with `sign` is required");let s=await Promise.all((t.preCalls??[]).map(async n=>{if(n.signature)return n;let{authorizeKeys:o,key:s,calls:c,revokeKeys:l}=n,{context:u,digest:d}=await Ya(e,{account:a,authorizeKeys:o,calls:c,chain:r,feeToken:t.feeToken,key:s,preCalls:!0,revokeKeys:l});return{context:u,signature:await V(s,{address:null,payload:d,webAuthn:i})}})),{capabilities:c,context:l,digest:u}=await Ya(e,{...t,account:a,chain:r,key:o,preCalls:s}),d=await(async()=>o?await V(o,{address:null,payload:u,webAuthn:i,wrap:!1}):await a.sign({hash:u}))();return await Qa(e,{capabilities:c.feeSignature?{feeSignature:c.feeSignature}:void 0,context:l,key:o,signature:d})}async function Qa(e,t){let{capabilities:n,context:r,key:i,signature:a}=t;return await za(e,{capabilities:n,context:r,key:i?Bn(i):void 0,signature:a})}async function $a(e,t){let{email:n,walletAddress:r}=t;return await Ba(e,{email:n,walletAddress:r})}async function eo(e,t){if(t.account){let{account:n}=t,r=[...n.keys??[],...t.authorizeKeys??[]].filter((e,t,n)=>n.findIndex(t=>t.id===e.id)===t),{digests:i,...a}=await Xa(e,{...t,address:n.address,authorizeKeys:r}),o={auth:await n.sign({hash:i.auth}),exec:await n.sign({hash:i.exec})};return await eo(e,{...a,signatures:o})}let{context:n,signatures:r}=t,i=Y(n.account);return await Va(e,{context:n,signatures:r}),i}async function to(e,t){let{chainId:n,email:r,signature:i,token:a,walletAddress:o}=t;return await Ha(e,{chainId:n,email:r,signature:i,token:a,walletAddress:o})}async function no(e,t){let{address:n}=t,{authorization:r,data:i,to:a}=await ja(e,{address:n});return Ue.wrap({authorization:{...r,nonce:BigInt(r.nonce),r:BigInt(r.r),s:BigInt(r.s)},data:i,signature:t.signature,to:a})}function ro(e,t){let{tokens:n}=t,r=n.filter(e=>e.interop);return e.map(e=>{if(e.address)return e;let t=r.find(t=>t.symbol===e.symbol);if(!t)throw Error(`interop token not found: ${e.symbol}`);return{address:t.address,value:De.from(e.value,t.decimals)}})}async function $(e,t){let{chain:n=e.chain}=t??{};return await Ma(e,{chainId:n?.id}).then(e=>e.fees.tokens)}async function io(e,t){let{addressOrSymbol:n}=t;return(await $(e,t)).find(io.predicate(n))}(function(e){function t(e){return t=>e?T.validate(e)?T.isEqual(t.address,e):e===`native`?t.address===S:e===t.symbol:!1}e.predicate=t})(io||={});async function ao(e,t){let{chain:n=e.chain,store:r}=t??{},i=r?.getState()??{},a=t?.addressOrSymbol??i.feeToken;return(await $(e,{chain:n}).then(e=>e.filter(e=>e.feeToken)))?.find(e=>a?a===`native`&&e.address===S||T.validate(a)&&T.isEqual(e.address,a)?!0:a===e.symbol:!1)}function oo(e={}){let t=e,{mock:n,multichain:r=!0,webAuthn:i}=t,a,o,s=(()=>{if(t.keystoreHost!==`self`&&!(typeof window<`u`&&window.location?.hostname===`localhost`))return t.keystoreHost})();return va({actions:{async addFunds(){throw new M.UnsupportedMethodError},async createAccount(e){let{admins:t,email:r,label:o,permissions:c,internal:l,signInWithEthereum:u}=e,{client:d}=l,f=zi(k.randomPrivateKey()),p=await $(d),m=n?An():await kn({createFn:i?.createFn,label:o||`${f.address.slice(0,8)}\u2026${f.address.slice(-6)}`,rpId:s,userId:E.from(f.address)}),h=await Z(c,{chainId:d.chain.id,feeTokens:p}),g=t?.map(e=>B(e)),_=await eo(d,{account:f,authorizeKeys:[m,...g??[],...h?[h]:[]]});a=f.address,r&&o&&await $a(d,{email:o,walletAddress:_.address});let v=await(async()=>{if(!u)return;let e=await Da(d,u,{address:_.address}),t=await Vi(f,{payload:Be.getSignPayload(D.fromString(e))});return{message:e,signature:await no(d,{address:_.address,signature:t})}})();return{account:{..._,signInWithEthereum:v}}},async getAccountVersion(e){let{address:t,internal:n}=e,{client:r}=n,{contracts:i}=await Ma(r),{accountImplementation:a}=i,o=await Aa(r,{account:Y(a)}).then(e=>e.version),s=await Aa(r,{account:t}).then(e=>e.version).catch(()=>o);if(!s||!o)throw Error(`version not found.`);return{current:s,latest:o}},async getAssets(e){let{account:t,chainFilter:n,assetFilter:r,assetTypeFilter:i,internal:a}=e,{client:o}=a;return await Na(o,{account:t,assetFilter:r,assetTypeFilter:i,chainFilter:n})},async getCallsStatus(e){let{id:t,internal:n}=e,{client:r}=n,i=await Pa(r,{id:t});return{atomic:!0,chainId:D.fromNumber(r.chain.id),id:t,receipts:i.receipts?.map(e=>({blockHash:e.blockHash,blockNumber:D.fromNumber(e.blockNumber),gasUsed:D.fromNumber(e.gasUsed),logs:e.logs,status:e.status,transactionHash:e.transactionHash})),status:i.status,version:`1.0`}},async getCapabilities(e){let{chainIds:t,internal:n}=e,{client:i}=n,a={atomic:{status:`supported`},atomicBatch:{supported:!0},feeToken:{supported:!0,tokens:[]},merchant:{supported:!0},permissions:{supported:!0},requiredFunds:{supported:!!r,tokens:[]}},o=await Ma(i,{chainIds:t?t.map(e=>D.toNumber(e)):`all`,raw:!0});return Object.entries(o).reduce((e,[t,n])=>({...e,[t]:{...a,...n,feeToken:{supported:!0,tokens:n.fees.tokens},requiredFunds:{supported:!!r,tokens:r?n.fees.tokens.filter(e=>e.interop):[]}}}),{})},async getKeys(e){let{account:t,chainIds:n,internal:r}=e,{client:i}=r;return Qi([...await Ja(i,{account:t,chainIds:n}),...t.keys??[]],e=>e.publicKey)},async grantAdmin(e){let{account:t,internal:n}=e,{client:r}=n,a=B(e.key,{chainId:r.chain.id}),o=await ao(r,{addressOrSymbol:e.feeToken,store:n.store}),{id:s}=await Za(r,{account:t,authorizeKeys:[a],feeToken:o?.address,webAuthn:i});return await w(r,{id:s,pollingInterval:500}),{key:a}},async grantPermissions(e){let{account:t,internal:n,permissions:r}=e,{client:i}=n,a=await $(i),o=await Z(r,{chainId:i.chain.id,feeTokens:a});if(!o)throw Error(`key to authorize not found.`);let s=t.keys?.find(e=>e.role===`admin`&&e.privateKey);if(!s)throw Error(`admin key not found.`);let{context:c,digest:l}=await Ya(i,{account:t,authorizeKeys:[o],key:s,preCalls:!0});return await Qa(i,{context:c,key:s,signature:await V(s,{address:null,payload:l})}),{key:o}},async loadAccounts(e){let{internal:t,permissions:r,signInWithEthereum:o}=e,{client:c}=t,l=await $(c),u=await Z(r,{chainId:c.chain.id,feeTokens:l}),{digest:d,digestType:f,message:p}=await(async()=>{if(o&&e.address){let t=await Da(c,o,{address:e.address});return{context:void 0,digest:Be.getSignPayload(D.fromString(t)),digestType:`siwe`,message:t}}return{context:void 0,digest:`0x`,message:void 0}})(),{address:m,credentialId:h,webAuthnSignature:g}=await(async()=>{if(n){if(!a)throw Error(`address_internal not found.`);return{address:a,credentialId:void 0}}if(e.address&&e.key)return{address:e.address,credentialId:e.key.credentialId};let t=await Oe.sign({challenge:d,getFn:i?.getFn,rpId:s}),r=t.raw.response;return{address:E.toHex(new Uint8Array(r.userHandle)),credentialId:t.raw.id,webAuthnSignature:t}})(),_=Y({address:m,keys:[...await Ja(c,{account:m,chainIds:[c.chain.id]}),...u?[u]:[]].map((e,t)=>t===0&&e.type===`webauthn-p256`?Fn({...e,credential:{id:h,publicKey:O.fromHex(e.publicKey)},id:m,rpId:s}):e)}),v=Bi(_,{role:`admin`}),y=await(async()=>{if(d!==`0x`)return g?Wn(Un(g),{keyType:`webauthn-p256`,publicKey:v.publicKey}):await V(v,{address:_.address,payload:d})})();if(u){let{context:e,digest:t}=await Ya(c,{account:_,authorizeKeys:[u],preCalls:!0});await Qa(c,{context:e,key:v,signature:await V(v,{address:null,payload:t})})}let b=await(async()=>{if(o){if(f===`siwe`&&p&&y)return{message:p,signature:await no(c,{address:_.address,signature:y})};{let e=await Da(c,o,{address:_.address}),t=await Vi(_,{payload:Be.getSignPayload(D.fromString(e)),role:`admin`});return{message:e,signature:await no(c,{address:_.address,signature:t})}}}})();return{accounts:[{..._,signInWithEthereum:b}]}},async prepareCalls(e){let{account:t,calls:n,internal:i,merchantUrl:a}=e,{client:o}=i,s=e.key??await ya({account:t,calls:n});if(!s)throw Error(`cannot find authorized key to sign with.`);let[c,l]=await Promise.all([$(o),ao(o,{addressOrSymbol:e.feeToken,store:i.store})]),u=ro(e.requiredFunds??[],{tokens:c}),{capabilities:d,context:f,digest:p,typedData:m}=await Ya(o,{account:t,calls:n,feeToken:l?.address,key:s,merchantUrl:a,requiredFunds:r?u:void 0}),h=f.quote?.quotes??[],g=h[h.length-1];return{account:t,capabilities:{...d,quote:f.quote},chainId:o.chain.id,context:{...f,account:t,calls:n,nonce:g?.intent.nonce},digest:p,key:s,typedData:m}},async prepareUpgradeAccount(e){let{address:t,email:r,label:a,internal:c,permissions:l}=e,{client:u}=c,[d,f]=await Promise.all([$(u),ao(u,{store:c.store})]),p=n?An():await kn({createFn:i?.createFn,label:a||`${t.slice(0,8)}\u2026${t.slice(-6)}`,rpId:s,userId:E.from(t)}),m=await Z(l,{chainId:u.chain.id,feeTokens:d}),{context:h,digests:g}=await Xa(u,{address:t,authorizeKeys:[p,...m?[m]:[]],feeToken:f?.address});return r&&(o=a),{context:h,digests:g}},async revokeAdmin(e){let{account:t,id:n,internal:r}=e,{client:a}=r,o=t.keys?.find(e=>e.id===n);if(o){if(o.type===`webauthn-p256`&&t.keys?.filter(e=>e.type===`webauthn-p256`).length===1)throw Error(`revoke the only WebAuthn key left.`);try{let{id:n}=await Za(a,{account:t,feeToken:(await ao(a,{addressOrSymbol:e.feeToken,store:r.store}))?.address,revokeKeys:[o],webAuthn:i});await w(a,{id:n})}catch(e){let t=e;if(t.name===`Rpc.ExecutionError`&&t.abiError?.name===`KeyDoesNotExist`)return;throw e}}},async revokePermissions(e){let{account:t,id:n,internal:r}=e,{client:a}=r,o=t.keys?.find(e=>e.id===n);if(o){if(o.role===`admin`)throw Error(`cannot revoke admins.`);try{let{id:n}=await Za(a,{account:t,feeToken:(await ao(a,{addressOrSymbol:e.feeToken,store:r.store}))?.address,revokeKeys:[o],webAuthn:i});await w(a,{id:n})}catch(e){let t=e;if(t.name===`Rpc.ExecutionError`&&t.abiError?.name===`KeyDoesNotExist`)return;throw e}}},async sendCalls(e){let{account:t,asTxHash:n,calls:a,chainId:o,internal:s,merchantUrl:c}=e,{client:l}=s,u=await ya({account:t,calls:a,permissionsId:e.permissionsId}),[d,f]=await Promise.all([$(l),ao(l,{addressOrSymbol:e.feeToken,store:s.store})]),p=ro(e.requiredFunds??[],{tokens:d}),m=await Za(l,{account:t,calls:a,feeToken:f?.address,key:u,merchantUrl:c,requiredFunds:r?p:void 0,webAuthn:i,...o?{chain:{id:o}}:{}});if(n){let{id:e,receipts:t,status:n}=await w(l,{id:m.id,pollingInterval:500});if(!t?.[0])throw n===`success`?new M.UnknownBundleIdError({message:`Call bundle with id: `+e+` not found.`}):new Le.TransactionRejectedError({message:`Transaction failed under call bundle id: `+e+`.`});return{id:t[0].transactionHash}}return m},async sendPreparedCalls(e){let{context:t,key:n,internal:r,signature:i}=e,{client:a}=r,{id:o}=await Qa(a,{context:t,key:n,signature:i});return o},async signPersonalMessage(e){let{account:t,data:n,internal:r}=e,{client:a}=r,o=t.keys?.find(e=>e.role===`admin`&&e.privateKey);if(!o)throw Error(`cannot find admin key to sign with.`);let s=await Vi(t,{key:o,payload:Be.getSignPayload(n),webAuthn:i});return no(a,{address:t.address,signature:s})},async signTypedData(e){let{account:t,internal:n}=e,{client:r}=n,a=t.keys?.find(e=>e.role===`admin`&&e.privateKey);if(!a)throw Error(`cannot find admin key to sign with.`);let o=Ce.parse(e.data),s=o.domain?.name===`Orchestrator`,c=await Vi(t,{key:a,payload:Ee.getSignPayload(o),replaySafe:!s,webAuthn:i});return s?c:no(r,{address:t.address,signature:c})},async upgradeAccount(e){let{account:t,context:n,internal:r,signatures:i}=e,{client:a}=r;return await eo(a,{context:n,signatures:i}),o&&await $a(a,{email:o,walletAddress:t.address}),{account:t}},async verifyEmail(e){let{account:t,chainId:n,email:r,token:a,internal:o,walletAddress:s}=e,{client:c}=o,l=t.keys?.find(e=>e.role===`admin`&&e.privateKey);if(!l)throw Error(`cannot find admin key to sign with.`);return await to(c,{chainId:n,email:r,signature:await Vi(t,{key:l,payload:Se.keccak256(D.fromString(`${r}${a}`)),webAuthn:i}),token:a,walletAddress:s})}},config:e,name:`rpc`})}function so(e={}){let{fallback:t=oo(),host:n=ia.prod,renderer:r=oa(),theme:i,themeController:a}=e,o=new Set,s=Ie.createStore();function c(e){return M.from({async request(t){let n=s.prepare(t);return e.setState(e=>{let t=e.accounts[0],r=t?.keys?.find(e=>e.role===`admin`&&e.type===`webauthn-p256`);return{...e,requestQueue:[...e.requestQueue,{account:t?{address:t.address,key:r?{credentialId:r?.credentialId,publicKey:r.publicKey}:void 0}:void 0,request:n,status:`pending`}]}}),new Promise((t,r)=>{let i=a=>{let s=a.find(e=>e.request.id===n.id);if(!s&&a.length===0){o.delete(i),r(new M.UserRejectedRequestError);return}s&&(s.status!==`success`&&s.status!==`error`||(o.delete(i),s.status===`success`?t(s.result):r(M.parseError(s.error)),e.setState(e=>({...e,requestQueue:e.requestQueue.filter(e=>e.request.id!==n.id)}))))};o.add(i)})}},{schema:Re.from()})}return va({actions:{async addFunds(e){let{internal:t}=e,{request:n,store:r}=t;if(n.method!==`wallet_addFunds`)throw Error(`Cannot add funds for method: `+n.method);return await c(r).request(n)},async createAccount(e){let{internal:t}=e,{client:n,config:r,request:i,store:a}=t,{storage:o}=r,s=c(a);return{account:await(async()=>{if(i.method===`wallet_connect`){let[{capabilities:e,chainIds:t}]=i._decoded.params??[{}],a=lo(e?.signInWithEthereum?.authUrl??r.authUrl,{storage:o}),c=i.params?.[0]?.capabilities?.signInWithEthereum,l=await Z(e?.grantPermissions,{chainId:n.chain.id}),u=l?A.encode(Ca,wa(l)):void 0,{accounts:d}=await s.request({...i,params:[{capabilities:{...i.params?.[0]?.capabilities,grantPermissions:u,signInWithEthereum:a||c?{...c,authUrl:a}:void 0},chainIds:t?.map(e=>D.fromNumber(e))}]}),[f]=d;if(!f)throw Error(`no account found.`);let p=f.capabilities?.admins?.map(e=>B(e,{chainId:n.chain.id})).filter(Boolean),m=f.capabilities?.permissions?.map(e=>{try{let t=Sa(A.decode(ba,e));return t.id===l?.id?{...t,...l,permissions:t.permissions}:t}catch{return}}).filter(Boolean),h=await(async()=>{if(!f.capabilities?.signInWithEthereum)return;let{message:e,signature:t}=f.capabilities.signInWithEthereum;if(!a)return{message:e,signature:t};let{token:n}=await Ea({address:f.address,authUrl:a,message:e,publicKey:f.capabilities?.admins?.[0]?.publicKey,signature:t});return{message:e,signature:t,token:n}})();return{...Y({address:f.address,keys:[...p??[],...m??[]]}),signInWithEthereum:h}}throw Error(`Account creation not supported on method: ${i.method}`)})()}},async disconnect(e){let{internal:t}=e,{config:n}=t,{storage:r}=n,i=await r.getItem(`porto.authUrl`)||void 0,a=lo(n.authUrl??i,{storage:r});a&&await fetch(a.logout,{credentials:`include`,method:`POST`}).catch(()=>{})},async getAccountVersion(e){let{internal:n}=e,{store:i,request:a}=n;if(a.method!==`wallet_getAccountVersion`)throw Error(`Cannot get version for method: `+a.method);return r.supportsHeadless?await c(i).request(a):t.actions.getAccountVersion(e)},async getAssets(e){let{internal:n}=e,{store:i,request:a}=n;if(a.method!==`wallet_getAssets`)throw Error(`Cannot get assets for method: `+a.method);if(!r.supportsHeadless)return t.actions.getAssets(e);let o=await c(i).request(a);return A.decode(ji.Response,o)},async getCallsStatus(e){let{internal:n}=e,{store:i,request:a}=n;if(a.method!==`wallet_getCallsStatus`)throw Error(`Cannot get status for method: `+a.method);return r.supportsHeadless?await c(i).request(a):t.actions.getCallsStatus(e)},async getCapabilities(e){let{internal:n}=e,{store:i,request:a}=n;if(a.method!==`wallet_getCapabilities`)throw Error(`Cannot get capabilities for method: `+a.method);return r.supportsHeadless?await c(i).request(a):t.actions.getCapabilities(e)},async getKeys(e){let{account:n,chainIds:i,internal:a}=e,{store:o}=a;return Qi([...await(async()=>{if(!r.supportsHeadless)return t.actions.getKeys(e);let a=await c(o).request({method:`wallet_getKeys`,params:[A.encode(Pi.Parameters,{address:n.address,chainIds:i})]});return A.decode(Pi.Response,a)})(),...n.keys??[]],e=>e.publicKey)},async grantAdmin(e){let{internal:t}=e,{request:n,store:r}=t;if(n.method!==`wallet_grantAdmin`)throw Error(`Cannot authorize admin for method: `+n.method);let[i]=n._decoded.params,a=B(i.key);if(!a)throw Error(`no key found.`);let o=await co(t,e);return await c(r).request({method:`wallet_grantAdmin`,params:[{...n.params?.[0],capabilities:{...n.params?.[0]?.capabilities,feeToken:o}}]}),{key:a}},async grantPermissions(e){let{internal:t}=e,{client:n,request:r,store:i}=t;if(r.method!==`wallet_grantPermissions`)throw Error(`Cannot grant permissions for method: `+r.method);let[{address:a,...o}]=r._decoded.params,s=await Z(o,{chainId:n.chain.id});if(!s)throw Error(`no key found.`);let l=A.encode(Ca,wa(s));return await c(i).request({method:`wallet_grantPermissions`,params:[l]}),{key:s}},async loadAccounts(e){let{internal:t}=e,{client:n,config:r,store:i}=t,{storage:a}=r,o=c(i),s=t.request;if(s.method!==`wallet_connect`&&s.method!==`eth_requestAccounts`)throw Error(`Cannot load accounts for method: `+s.method);return{accounts:await(async()=>{let[e]=s._decoded.params??[],{capabilities:t}=e??{},i=lo(t?.signInWithEthereum?.authUrl??r.authUrl,{storage:a}),c=s.params?.[0]?.capabilities?.signInWithEthereum,l=await Z(t?.grantPermissions,{chainId:n.chain.id}),u=l?A.encode(Ca,wa(l)):void 0,{accounts:d}=await o.request({method:`wallet_connect`,params:[{...s.params?.[0],capabilities:{...s.params?.[0]?.capabilities,grantPermissions:u,signInWithEthereum:i||c?{...c,authUrl:i}:void 0}}]});return Promise.all(d.map(async e=>{let t=e.capabilities?.admins?.map(e=>B(e)).filter(Boolean),n=e.capabilities?.permissions?.map(e=>{try{let t=Sa(A.decode(ba,e));return t.id===l?.id?{...t,...l,permissions:t.permissions}:t}catch{return}}).filter(Boolean),r=await(async()=>{if(!e.capabilities?.signInWithEthereum)return;let{message:t,signature:n}=e.capabilities.signInWithEthereum;if(!i)return{message:t,signature:n};let{token:r}=await Ea({address:e.address,authUrl:i,message:t,publicKey:e.capabilities?.admins?.[0]?.publicKey,signature:n});return{message:t,signature:n,token:r}})();return{...Y({address:e.address,keys:[...t??[],...n??[]]}),signInWithEthereum:r}}))})()}},async prepareCalls(e){let{account:n,internal:i}=e,{store:a,request:o}=i;if(o.method!==`wallet_prepareCalls`)throw Error(`Cannot prepare calls for method: `+o.method);if(!r.supportsHeadless)return t.actions.prepareCalls(e);let s=await co(i,e),l=c(a),u=A.decode(J.Response,await l.request({...o,params:[{...o.params?.[0],capabilities:{...o.params?.[0]?.capabilities,feeToken:s}}]}));return{account:n,chainId:Number(u.chainId),context:u.context,digest:u.digest,key:u.key,typedData:u.typedData}},async prepareUpgradeAccount(e){let{internal:n}=e,{client:i,store:a,request:o}=n;if(o.method!==`wallet_prepareUpgradeAccount`)throw Error(`Cannot prepare upgrade for method: `+o.method);if(!r.supportsHeadless)return t.actions.prepareUpgradeAccount(e);let[{capabilities:s}]=o._decoded.params??[{}],l=await Z(s?.grantPermissions,{chainId:i.chain.id}),u=l?A.encode(Ca,wa(l)):void 0,{context:d,digests:f}=await c(a).request({...o,params:[{...o.params?.[0],capabilities:{...o.params?.[0]?.capabilities,grantPermissions:u}}]}),p=d.account.keys?.map(e=>e.id===l?.id?{...e,...l}:e);return{context:{...d,account:{...d.account,keys:p}},digests:f}},async revokeAdmin(e){let{account:t,id:n,internal:r}=e,{store:i,request:a}=r;if(a.method!==`wallet_revokeAdmin`)throw Error(`Cannot revoke admin for method: `+a.method);let o=t.keys?.find(e=>e.id===n);if(!o)return;if(o.type===`webauthn-p256`&&t.keys?.filter(e=>e.type===`webauthn-p256`).length===1)throw Error(`revoke the only WebAuthn key left.`);let s=await co(r,e);return await c(i).request({...a,params:[{...a.params?.[0],capabilities:{...a.params?.[0]?.capabilities,feeToken:s}}]})},async revokePermissions(e){let{account:t,id:n,internal:r}=e,{store:i,request:a}=r;if(a.method!==`wallet_revokePermissions`)throw Error(`Cannot revoke permissions for method: `+a.method);let o=t.keys?.find(e=>e.id===n);if(o){if(o.role===`admin`)throw Error(`cannot revoke permissions.`);return await c(i).request(a)}},async sendCalls(e){let{account:n,asTxHash:i,calls:a,chainId:o,internal:s,merchantUrl:l,requiredFunds:u}=e,{client:d,store:f,request:p}=s,m=c(f),h=await co(s,e),g=await ya({account:n,calls:a,permissionsId:e.permissionsId});if(g&&g.role===`session`){if(!r.supportsHeadless)return t.actions.sendCalls(e);try{let e=await m.request(A.encode(J.Request,{method:`wallet_prepareCalls`,params:[{calls:a,capabilities:{...p._decoded.method===`wallet_sendCalls`?p._decoded.params?.[0]?.capabilities:void 0,feeToken:h,merchantUrl:l,requiredFunds:u},chainId:o,from:n.address,key:g}]})),t=e.capabilities?.quote?.quotes??[];if(t.some((e,n)=>n===t.length-1&&t.length>1?!1:D.toBigInt(e.feeTokenDeficit)>0n))throw Error(`insufficient funds`);let r=await V(g,{address:null,payload:e.digest,wrap:!1}),s=(await m.request({method:`wallet_sendPreparedCalls`,params:[{...e,signature:r}]}))[0];if(!s)throw Error(`id not found`);if(i){let{id:e,receipts:t,status:n}=await w(d,{id:s.id,pollingInterval:500});if(!t?.[0])throw n===`success`?new M.UnknownBundleIdError({message:`Call bundle with id: `+e+` not found.`}):new Le.TransactionRejectedError({message:`Transaction failed under call bundle id: `+e+`.`});return{id:t[0].transactionHash}}return s}catch{}}if(p.method===`eth_sendTransaction`)return{id:await m.request({...p,params:[{...p.params?.[0],capabilities:{feeToken:h,merchantUrl:l},...o?{chainId:D.fromNumber(o)}:{}}]})};if(p.method===`wallet_sendCalls`)return await m.request({method:`wallet_sendCalls`,params:[{...p.params?.[0],capabilities:{...p.params?.[0]?.capabilities,feeToken:h,merchantUrl:l},...o?{chainId:D.fromNumber(o)}:{}}]});throw Error(`Cannot execute for method: `+p.method)},async sendPreparedCalls(e){let{internal:n}=e,{store:i,request:a}=n;if(a.method!==`wallet_sendPreparedCalls`)throw Error(`Cannot send prepared calls for method: `+a.method);if(!r.supportsHeadless)return t.actions.sendPreparedCalls(e);let o=(await c(i).request(a))[0]?.id;if(!o)throw Error(`id not found`);return o},async signPersonalMessage(e){let{internal:t}=e,{store:n,request:r}=t;if(r.method!==`personal_sign`)throw Error(`Cannot sign personal message for method: `+r.method);return await c(n).request(r)},async signTypedData(e){let{internal:t}=e,{store:n,request:r}=t;if(r.method!==`eth_signTypedData_v4`)throw Error(`Cannot sign typed data for method: `+r.method);return await c(n).request(r)},async switchChain(e){let{internal:t}=e,{store:n,request:i}=t;if(i.method!==`wallet_switchEthereumChain`)throw Error(`Cannot switch chain for method: `+i.method);if(r.supportsHeadless)return await c(n).request(i)},async upgradeAccount(e){let{account:t,internal:n}=e,{store:r,request:i}=n;if(i.method!==`wallet_upgradeAccount`)throw Error(`Cannot upgrade account for method: `+i.method);return await c(r).request(i),{account:t}},async verifyEmail(e){let{internal:t}=e,{request:n,store:r}=t;if(n.method!==`account_verifyEmail`)throw Error(`Cannot verify email for method: `+n.method);return await c(r).request(n)}},config:e,name:`dialog`,setup(e){let{internal:t}=e,{store:s}=t,c=r.setup({host:n,internal:t,theme:i,themeController:a}),l=s.subscribe(e=>e.requestQueue,e=>{for(let t of o)t(e);let t=e.map(e=>e.status===`pending`?e:void 0).filter(Boolean);c.syncRequests(t).catch(()=>{}),t.length===0&&c.close()});return()=>{l(),c.destroy()}}})}async function co(e,t){let{config:{feeToken:n}}=e,{feeToken:r}=t??{};return r??n}function lo(e,{storage:t}){if(!e)return;let n=Oa(e,typeof window<`u`?window.location.origin:void 0);return n&&t.setItem(`porto.authUrl`,n),n}const uo={anvil:{http:`http://localhost:9119`},prod:{http:`https://rpc.porto.sh`},stg:{http:`https://stg-rpc.porto.sh`}};function fo(e){return t=>{let n=e.public(t),r=e.relay(t);return p({key:fo.type,name:`Relay Proxy`,async request({method:e,params:t},i){return po(e)?r.request({method:e,params:t},i):n.request({method:e,params:t},i)},type:fo.type})}}(function(e){e.type=`relayProxy`})(fo||={});function po(e){return!!(e.startsWith(`wallet_`)||e.startsWith(`account_`)||e===`health`)}const mo=new Map;function ho(e,t={}){let{config:n,id:r,store:i}=e._internal,{chains:a,relay:o}=n,s=i.getState(),c=t.chainId??s.chainIds[0],l=a.find(e=>e.id===c);if(!l)throw Error([`Could not find a compatible Porto chain on the given chain configuration.`,``,`Provided chains: [${a.map(e=>`${e.name} (id: ${e.id})`).join(`, `)}]`,`Needed chain (id): ${c}`,`Please add this chain (id) to your chain configuration.`].join(`
`));let u=fo({public:n.transports[l.id]??g(l.rpcUrls.default.http.map(e=>b(e))),relay:o}),d=[r,Ce.stringify(l)].filter(Boolean).join(`:`);if(mo.has(d))return mo.get(d);let p=f({...t,chain:l,pollingInterval:1e3,transport:u});return mo.set(d,p),p}const go=A.discriminatedUnion(`method`,[ui.Request,fi.Request,pi.Request,mi.Request,hi.Request,gi.Request,_i.Request,xi.Request,vi.Request,Si.Request,yi.Request,bi.Request,Fi.Request,Ci.Request,wi.Request,Ei.Request,Di.Request,Oi.Request,ki.Request,Ai.Request,ji.Request,Mi.Request,Ni.Request,Pi.Request,J.Request,Ii.Request,Li.Request,Ti.Request,Ri.Request]);function _o(e,t){let n=A.safeParse(e,t);if(n.error){let e=n.error.issues.at(0);throw e?.code===`invalid_union`&&e.note===`No matching discriminator`?new Le.MethodNotSupportedError:new Le.InvalidParamsError(qn(n.error))}return{...t,_decoded:n.data}}async function vo(e){e.persist.hasHydrated()||await new Promise(t=>{e.persist.onFinishHydration(()=>t(!0)),setTimeout(()=>t(!0),100)})}function yo(e){if(e)return e.startsWith(`/`)?`${window.location.origin}${e}`:e}function bo(e){let{config:t,getMode:n,id:r,store:i}=e,{announceProvider:a}=t;function o(e={}){let a=s(),o=e.request??_o(go,{method:`wallet_getCapabilities`,params:e.chainIds?[void 0,e.chainIds]:void 0});return x(()=>n().actions.getCapabilities({chainIds:e.chainIds,internal:{client:a,config:t,request:o,store:i}}),{cacheKey:`getCapabilities.${r}.${e.chainIds?.join(`,`)}`})}function s(t){let n=typeof t==`string`?D.toNumber(t):t;return ho({_internal:e},{chainId:n})}let c=new Map,l=[],u=M.createEmitter(),d=M.from({...u,async request(e){return await vo(i),ea(async()=>{let r;try{r=_o(go,e)}catch(t){let n=t;if(!(n instanceof Le.MethodNotSupportedError))throw n;if(e.method.startsWith(`wallet_`))throw new M.UnsupportedMethodError;return s().request(e)}let a=i.getState();switch(r.method){case`account_verifyEmail`:{if(a.accounts.length===0)throw new M.DisconnectedError;let[e]=r._decoded.params,{chainId:o,email:c,token:l,walletAddress:u}=e,d=s(o);if(o&&o!==d.chain.id)throw new M.ChainDisconnectedError;let f=u?a.accounts.find(e=>T.isEqual(e.address,u)):a.accounts[0];if(!f)throw new M.UnauthorizedError;return await n().actions.verifyEmail({account:f,chainId:o,email:c,internal:{client:d,config:t,request:r,store:i},token:l,walletAddress:u})}case`wallet_addFunds`:{if(a.accounts.length===0)throw new M.DisconnectedError;let{address:e,value:o,token:c}=r.params[0]??{},l=e?a.accounts.find(t=>T.isEqual(t.address,e)):a.accounts[0];if(!l)throw new M.UnauthorizedError;let d=s(),f=await n().actions.addFunds({address:l.address,internal:{client:d,config:t,request:r,store:i},token:c,value:o});return u.emit(`message`,{data:null,type:`assetsChanged`}),f}case`eth_accounts`:if(a.accounts.length===0)throw new M.DisconnectedError;return a.accounts.map(wo);case`eth_chainId`:return D.fromNumber(a.chainIds[0]);case`eth_requestAccounts`:{if(a.accounts.length>0&&c.get(`eth_requestAccounts`))return a.accounts.map(wo);let e=s(),{accounts:o}=await n().actions.loadAccounts({internal:{client:e,config:t,request:r,store:i}});return i.setState(e=>({...e,accounts:o})),u.emit(`connect`,{chainId:D.fromNumber(e.chain.id)}),c.set(`eth_requestAccounts`,!0),setTimeout(()=>c.delete(`eth_requestAccounts`),1e3),o.map(wo)}case`eth_sendTransaction`:{if(a.accounts.length===0)throw new M.DisconnectedError;let[{capabilities:e,chainId:o,data:c=`0x`,from:l,to:u,value:d}]=r._decoded.params,f=s(o);if(o&&o!==f.chain.id)throw new M.ChainDisconnectedError;let p=l?a.accounts.find(e=>T.isEqual(e.address,l)):a.accounts[0];if(!p)throw new M.UnauthorizedError;let{id:m}=await n().actions.sendCalls({account:p,asTxHash:!0,calls:[{data:c,to:u,value:d}],chainId:f.chain.id,internal:{client:f,config:t,request:r,store:i},merchantUrl:yo(t.merchantUrl??e?.merchantUrl)});return m}case`eth_signTypedData_v4`:{if(a.accounts.length===0)throw new M.DisconnectedError;let[e,o]=r._decoded.params,c=a.accounts.find(t=>T.isEqual(t.address,e));if(!c)throw new M.UnauthorizedError;let l=s();return await n().actions.signTypedData({account:c,data:o,internal:{client:l,config:t,request:r,store:i}})}case`wallet_grantAdmin`:{if(a.accounts.length===0)throw new M.DisconnectedError;let[{address:e,capabilities:o,chainId:c,key:l}]=r._decoded.params??[{}],d=e?a.accounts.find(t=>T.isEqual(t.address,e)):a.accounts[0];if(!d)throw new M.UnauthorizedError;let f=s(c);if(So([...d.keys??[]])?.some(e=>e.publicKey?.toLowerCase()===l.publicKey.toLowerCase()))throw new Le.InvalidParamsError({message:`Key already granted as admin.`});let{key:p}=await n().actions.grantAdmin({account:d,feeToken:o?.feeToken,internal:{client:f,config:t,request:r,store:i},key:l});i.setState(e=>{let t=e.accounts.findIndex(e=>d?T.isEqual(e.address,d.address):!0);return t===-1?e:{...e,accounts:e.accounts.map((e,n)=>n===t?{...e,keys:[...e.keys??[],p]}:e)}});let m=So([...d.keys??[],p]);return u.emit(`message`,{data:null,type:`adminsChanged`}),A.encode(yi.Response,{address:d.address,chainId:f.chain.id,key:m.at(-1)})}case`wallet_grantPermissions`:{if(a.accounts.length===0)throw new M.DisconnectedError;let[{address:e,chainId:o,...c}]=r._decoded.params??[{}],l=e?a.accounts.find(t=>T.isEqual(t.address,e)):a.accounts[0];if(!l)throw new M.UnauthorizedError;let d=s(o),{key:f}=await n().actions.grantPermissions({account:l,internal:{client:d,config:t,request:r,store:i},permissions:c});return i.setState(e=>{let t=e.accounts.findIndex(e=>l?T.isEqual(e.address,l.address):!0);return t===-1?e:{...e,accounts:e.accounts.map((e,n)=>n===t?{...e,keys:[...e.keys??[],f]}:e)}}),u.emit(`message`,{data:null,type:`permissionsChanged`}),A.encode(bi.Response,{...xa(f,{address:l.address})})}case`wallet_getAdmins`:{if(a.accounts.length===0)throw new M.DisconnectedError;let[{address:e,chainId:o}]=r._decoded.params??[{}],c=e?a.accounts.find(t=>T.isEqual(t.address,e)):a.accounts[0];if(!c)throw new M.UnauthorizedError;let l=s(o),u=So(await n().actions.getKeys({account:c,internal:{client:l,config:t,request:r,store:i}}));return A.encode(vi.Response,{address:c.address,chainId:l.chain.id,keys:u})}case`wallet_prepareUpgradeAccount`:{let[{address:e,capabilities:a,chainId:o}]=r._decoded.params??[{}],{email:c,label:u,grantPermissions:d}=a??{},f=s(o),{context:p,digests:m}=await n().actions.prepareUpgradeAccount({address:e,email:c,internal:{client:f,config:t,request:r,store:i},label:u,permissions:d});return l.push(p.account),{context:p,digests:m}}case`wallet_getAccountVersion`:{if(a.accounts.length===0)throw new M.DisconnectedError;let[{address:e}]=r._decoded.params??[{}],o=e?a.accounts.find(t=>T.isEqual(t.address,e)):a.accounts[0];if(!o)throw new M.UnauthorizedError;let c=s(),{current:l,latest:u}=await n().actions.getAccountVersion({address:o.address,internal:{client:c,config:t,request:r,store:i}});return{current:l,latest:u}}case`wallet_getKeys`:{if(a.accounts.length===0)throw new M.DisconnectedError;let[{address:e,chainIds:o}]=r._decoded.params??[{}],c=a.accounts.find(t=>T.isEqual(t.address,e));if(!c)throw new M.UnauthorizedError;let l=s(),u=await n().actions.getKeys({account:c,chainIds:o,internal:{client:l,config:t,request:r,store:i}});return A.encode(Pi.Response,u)}case`wallet_getPermissions`:{if(a.accounts.length===0)throw new M.DisconnectedError;let[{address:e,chainIds:o}]=r._decoded.params??[{}],c=e?a.accounts.find(t=>T.isEqual(t.address,e)):a.accounts[0];if(!c)throw new M.UnauthorizedError;let l=s();return Co(await n().actions.getKeys({account:c,chainIds:o,internal:{client:l,config:t,request:r,store:i}}),{address:c.address})}case`wallet_revokeAdmin`:{if(a.accounts.length===0)throw new M.DisconnectedError;let[{address:e,capabilities:o,id:c}]=r._decoded.params,l=e?a.accounts.find(t=>T.isEqual(t.address,e)):a.accounts[0];if(!l)throw new M.UnauthorizedError;let d=s();await n().actions.revokeAdmin({account:l,feeToken:o?.feeToken,id:c,internal:{client:d,config:t,request:r,store:i}});let f=l.keys?.filter(e=>e.id.toLowerCase()!==c.toLowerCase());i.setState(e=>({...e,accounts:e.accounts.map(e=>T.isEqual(e.address,l.address)?{...e,keys:f}:e)})),u.emit(`message`,{data:null,type:`adminsChanged`});return}case`wallet_revokePermissions`:{if(a.accounts.length===0)throw new M.DisconnectedError;let[{address:e,capabilities:o,id:c}]=r._decoded.params,l=e?a.accounts.find(t=>T.isEqual(t.address,e)):a.accounts[0];if(!l)throw new M.UnauthorizedError;let d=s();await n().actions.revokePermissions({account:l,feeToken:o?.feeToken,id:c,internal:{client:d,config:t,request:r,store:i}});let f=l.keys?.filter(e=>e.id.toLowerCase()!==c.toLowerCase());i.setState(e=>({...e,accounts:e.accounts.map(e=>T.isEqual(e.address,l.address)?{...e,keys:f}:e)})),u.emit(`message`,{data:null,type:`permissionsChanged`});return}case`wallet_upgradeAccount`:{let[{context:e,signatures:a}]=r._decoded.params??[{}],o=s(),c=l.find(t=>T.isEqual(t.address,e.account.address));if(!c)throw new M.UnauthorizedError;let{account:d}=await n().actions.upgradeAccount({account:c,context:e,internal:{client:o,config:t,request:r,store:i},signatures:a}),f=So(d.keys??[]),p=Co(d.keys??[],{address:d.address});return i.setState(e=>({...e,accounts:[d]})),u.emit(`connect`,{chainId:D.fromNumber(o.chain.id)}),{address:d.address,capabilities:{admins:f,...p.length>0?{permissions:p}:{}}}}case`porto_ping`:return`pong`;case`personal_sign`:{if(a.accounts.length===0)throw new M.DisconnectedError;let[e,o]=r._decoded.params,c=a.accounts.find(e=>T.isEqual(e.address,o));if(!c)throw new M.UnauthorizedError;let l=s();return await n().actions.signPersonalMessage({account:c,data:e,internal:{client:l,config:t,request:r,store:i}})}case`wallet_connect`:{let[{capabilities:e,chainIds:o}]=r._decoded.params??[{}],c=s(o?.[0]),l=c.chain.id,{createAccount:d,email:f,grantAdmins:p,grantPermissions:m,selectAccount:h,signInWithEthereum:g}=e??{},_={client:c,config:t,request:r,store:i},{accounts:v}=await(async()=>{if(f||d){let{label:e=void 0}=typeof d==`object`?d:{},{account:t}=await n().actions.createAccount({admins:p,email:f,internal:_,label:e,permissions:m,signInWithEthereum:g});return{accounts:[t]}}let e=a.accounts[0],{address:t,key:r}=(()=>{if(h)return typeof h==`object`?h:{address:void 0,key:void 0};for(let t of e?.keys??[])if(t.type===`webauthn-p256`&&t.role===`admin`)return{address:e?.address,key:{credentialId:t.credentialId??t.privateKey?.credential?.id,publicKey:t.publicKey}};return{address:void 0,key:void 0}})(),i={internal:_,permissions:m,signInWithEthereum:g};try{return await n().actions.loadAccounts({address:t,key:r,...i})}catch(e){if(e instanceof M.UserRejectedRequestError)throw e;if(t&&r)return await n().actions.loadAccounts(i);throw e}})();i.setState(e=>({...e,accounts:v}));let y=[l,...i.getState().chainIds.filter(e=>e!==l)];return u.emit(`connect`,{chainId:D.fromNumber(y[0])}),{accounts:v.map(e=>({address:wo(e),capabilities:{admins:e.keys?So(e.keys):[],permissions:e.keys?Co(e.keys,{address:e.address}):[],...e.signInWithEthereum&&{signInWithEthereum:e.signInWithEthereum}}})),chainIds:y.map(e=>D.fromNumber(e))}}case`wallet_disconnect`:{let e=s();await n().actions.disconnect?.({internal:{client:e,config:t,request:r,store:i}}),i.setState(e=>({...e,accounts:[]})),u.emit(`disconnect`,new M.DisconnectedError);return}case`wallet_getAssets`:{let[e]=r._decoded.params??[],{account:a,chainFilter:o,assetFilter:c,assetTypeFilter:l}=e,u=s(),d=await n().actions.getAssets({account:a,assetFilter:c,assetTypeFilter:l,chainFilter:o,internal:{client:u,config:t,request:r,store:i}}),f=Object.entries(d).reduce((e,[t,n])=>(e[D.fromNumber(Number(t))]=n,e),{});return A.encode(ji.Response,f)}case`wallet_getCallsStatus`:{let[e]=r._decoded.params??[],a=s();return await n().actions.getCallsStatus({id:e,internal:{client:a,config:t,request:r,store:i}})}case`wallet_getCapabilities`:{let[e,t]=r.params??[];return await o({chainIds:t,request:r})}case`wallet_prepareCalls`:{let[e]=r._decoded.params,{calls:o,capabilities:c,chainId:l,key:u,from:d}=e,f=s(l),p=d??a.accounts[0];if(!p)throw new M.UnauthorizedError;if(l&&l!==f.chain.id)throw new M.ChainDisconnectedError;let{digest:m,...h}=await n().actions.prepareCalls({account:Y(p),calls:o,feeToken:c?.feeToken,internal:{client:f,config:t,request:r,store:i},key:u,merchantUrl:yo(t.merchantUrl??c?.merchantUrl),requiredFunds:c?.requiredFunds});return A.encode(J.Response,{capabilities:h.capabilities,chainId:D.fromNumber(h.chainId??f.chain.id),context:{...h.context,account:{address:h.account.address},calls:h.context.calls??[],nonce:h.context.nonce??0n},digest:m,key:h.key,typedData:h.typedData})}case`wallet_sendPreparedCalls`:{let[e]=r._decoded.params,{chainId:a,context:o,key:c,signature:l}=e,{account:u}=e.context,d=s(a);if(a&&D.toNumber(a)!==d.chain.id)throw new M.ChainDisconnectedError;return[{id:await n().actions.sendPreparedCalls({account:Y(u),context:o,internal:{client:d,config:t,request:r,store:i},key:c,signature:l})}]}case`wallet_sendCalls`:{if(a.accounts.length===0)throw new M.DisconnectedError;let[e]=r._decoded.params,{calls:o,capabilities:c,chainId:l,from:u}=e,d=s(l);if(l&&l!==d.chain.id)throw new M.ChainDisconnectedError;let f=u?a.accounts.find(e=>T.isEqual(e.address,u)):a.accounts[0];if(!f)throw new M.UnauthorizedError;let{id:p}=await n().actions.sendCalls({account:f,calls:o,chainId:d.chain.id,feeToken:c?.feeToken,internal:{client:d,config:t,request:r,store:i},merchantUrl:yo(t.merchantUrl??c?.merchantUrl),permissionsId:c?.permissions?.id,requiredFunds:c?.requiredFunds});return{id:p}}case`wallet_switchEthereumChain`:{let[e]=r._decoded.params,{chainId:a}=e,o=D.toNumber(a);if(!t.chains.find(e=>e.id===o))throw new M.UnsupportedChainIdError;let c=s(a);await n().actions.switchChain?.({chainId:c.chain.id,internal:{client:c,config:t,request:r,store:i}}),i.setState(e=>({...e,chainIds:[o,...e.chainIds.filter(e=>e!==o)]}));return}case`wallet_verifySignature`:{let[e]=r._decoded.params,{address:t,chainId:n,digest:i,signature:a}=e,o=s(n);return{...await Wa(o,{address:t,digest:i,signature:a}),address:t,chainId:D.fromNumber(o.chain.id)}}}},{enabled:[`eth_accounts`,`eth_chainId`,`eth_requestAccounts`,`wallet_getAssets`,`wallet_getCapabilities`,`wallet_getKeys`,`wallet_getPermissions`,`wallet_getAccountVersion`,`wallet_connect`].includes(e.method),id:Ce.stringify(e)})}});function f(){let e=()=>{},t=()=>{};vo(i).then(()=>{o().catch(()=>{}),e(),e=i.subscribe(e=>e.accounts,e=>{u.emit(`accountsChanged`,e.map(wo))},{equalityFn:(e,t)=>e.every((e,n)=>e.address===t[n]?.address)}),t(),t=i.subscribe(e=>e.chainIds[0],(e,t)=>{e!==t&&u.emit(`chainChanged`,D.fromNumber(e))})});let n=xo(d,a);return()=>{e(),t(),n()}}let p=f();return Object.assign(d,{_internal:{destroy:p}})}function xo(e,t){if(!t||typeof window>`u`||!window.dispatchEvent)return()=>{};let{icon:n=`data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDIyIiBoZWlnaHQ9IjQyMiIgdmlld0JveD0iMCAwIDQyMiA0MjIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSI0MjIiIGhlaWdodD0iNDIyIiBmaWxsPSJibGFjayIvPgo8ZyBjbGlwLXBhdGg9InVybCgjY2xpcDBfMV8xNSkiPgo8cGF0aCBkPSJNODEgMjg2LjM2NkM4MSAyODAuODkzIDg1LjQ1MDUgMjc2LjQ1NSA5MC45NDA0IDI3Ni40NTVIMzI5LjUxMUMzMzUuMDAxIDI3Ni40NTUgMzM5LjQ1MiAyODAuODkzIDMzOS40NTIgMjg2LjM2NlYzMDYuMTg4QzMzOS40NTIgMzExLjY2MiAzMzUuMDAxIDMxNi4wOTkgMzI5LjUxMSAzMTYuMDk5SDkwLjk0MDRDODUuNDUwNSAzMTYuMDk5IDgxIDMxMS42NjIgODEgMzA2LjE4OFYyODYuMzY2WiIgZmlsbD0id2hpdGUiIGZpbGwtb3BhY2l0eT0iMC41Ii8+CjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNOTAuOTQwNCAyMzQuODI4Qzg1LjQ1MDUgMjM0LjgyOCA4MSAyMzkuMjY2IDgxIDI0NC43MzlWMjcxLjUzMUM4My44NDMyIDI2OS42MzMgODcuMjYyMiAyNjguNTI2IDkwLjk0MDQgMjY4LjUyNkgzMjkuNTExQzMzMy4xODggMjY4LjUyNiAzMzYuNjA4IDI2OS42MzMgMzM5LjQ1MiAyNzEuNTMxVjI0NC43MzlDMzM5LjQ1MiAyMzkuMjY2IDMzNS4wMDEgMjM0LjgyOCAzMjkuNTExIDIzNC44MjhIOTAuOTQwNFpNMzM5LjQ1MiAyODYuMzY2QzMzOS40NTIgMjgwLjg5MyAzMzUuMDAxIDI3Ni40NTUgMzI5LjUxMSAyNzYuNDU1SDkwLjk0MDRDODUuNDUwNSAyNzYuNDU1IDgxIDI4MC44OTMgODEgMjg2LjM2NlYzMDYuMTlDODEgMzExLjY2NCA4NS40NTA1IDMxNi4xMDEgOTAuOTQwNCAzMTYuMTAxSDMyOS41MTFDMzM1LjAwMSAzMTYuMTAxIDMzOS40NTIgMzExLjY2NCAzMzkuNDUyIDMwNi4xOVYyODYuMzY2WiIgZmlsbD0id2hpdGUiIGZpbGwtb3BhY2l0eT0iMC41Ii8+CjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNOTAuOTQwNCAxOTMuMjAxQzg1LjQ1MDUgMTkzLjIwMSA4MSAxOTcuNjM4IDgxIDIwMy4xMTJWMjI5LjkwM0M4My44NDMyIDIyOC4wMDYgODcuMjYyMiAyMjYuODk5IDkwLjk0MDQgMjI2Ljg5OUgzMjkuNTExQzMzMy4xODggMjI2Ljg5OSAzMzYuNjA4IDIyOC4wMDYgMzM5LjQ1MiAyMjkuOTAzVjIwMy4xMTJDMzM5LjQ1MiAxOTcuNjM4IDMzNS4wMDEgMTkzLjIwMSAzMjkuNTExIDE5My4yMDFIOTAuOTQwNFpNMzM5LjQ1MiAyNDQuNzM5QzMzOS40NTIgMjM5LjI2NSAzMzUuMDAxIDIzNC44MjggMzI5LjUxMSAyMzQuODI4SDkwLjk0MDRDODUuNDUwNSAyMzQuODI4IDgxIDIzOS4yNjUgODEgMjQ0LjczOVYyNzEuNTNDODEuMjE3NSAyNzEuMzg1IDgxLjQzODMgMjcxLjI0NSA4MS42NjI0IDI3MS4xMDlDODMuODMyNSAyNjkuNzk0IDg2LjMwNTQgMjY4LjkyNyA4OC45NTIzIDI2OC42MzVDODkuNjA1MSAyNjguNTYzIDkwLjI2ODQgMjY4LjUyNiA5MC45NDA0IDI2OC41MjZIMzI5LjUxMUMzMzAuMTgzIDI2OC41MjYgMzMwLjg0NiAyNjguNTYzIDMzMS40OTggMjY4LjYzNUMzMzQuNDE5IDI2OC45NTcgMzM3LjEyOCAyNjkuOTggMzM5LjQ1MiAyNzEuNTNWMjQ0LjczOVpNMzM5LjQ1MiAyODYuMzY2QzMzOS40NTIgMjgxLjAyMSAzMzUuMjA2IDI3Ni42NjMgMzI5Ljg5MyAyNzYuNDYyQzMyOS43NjcgMjc2LjQ1NyAzMjkuNjQgMjc2LjQ1NSAzMjkuNTExIDI3Ni40NTVIOTAuOTQwNEM4NS40NTA1IDI3Ni40NTUgODEgMjgwLjg5MyA4MSAyODYuMzY2VjMwNi4xODhDODEgMzExLjY2MiA4NS40NTA1IDMxNi4xMDEgOTAuOTQwNCAzMTYuMTAxSDMyOS41MTFDMzM1LjAwMSAzMTYuMTAxIDMzOS40NTIgMzExLjY2MiAzMzkuNDUyIDMwNi4xODhWMjg2LjM2NloiIGZpbGw9IndoaXRlIiBmaWxsLW9wYWNpdHk9IjAuNSIvPgo8cGF0aCBvcGFjaXR5PSIwLjMiIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNOTguMDE0NiAxMDRDODguNjE3NyAxMDQgODEgMTExLjU5NSA4MSAxMjAuOTY1VjE4OC4yNzZDODMuODQzMiAxODYuMzc5IDg3LjI2MjIgMTg1LjI3MiA5MC45NDA0IDE4NS4yNzJIMzI5LjUxMUMzMzMuMTg4IDE4NS4yNzIgMzM2LjYwOCAxODYuMzc5IDMzOS40NTIgMTg4LjI3NlYxMjAuOTY1QzMzOS40NTIgMTExLjU5NSAzMzEuODMzIDEwNCAzMjIuNDM3IDEwNEg5OC4wMTQ2Wk0zMzkuNDUyIDIwMy4xMTJDMzM5LjQ1MiAxOTcuNjM4IDMzNS4wMDEgMTkzLjIwMSAzMjkuNTExIDE5My4yMDFIOTAuOTQwNEM4NS40NTA1IDE5My4yMDEgODEgMTk3LjYzOCA4MSAyMDMuMTEyVjIyOS45MDNDODEuMjE3NSAyMjkuNzU4IDgxLjQzODMgMjI5LjYxOCA4MS42NjI0IDIyOS40ODJDODMuODMyNSAyMjguMTY3IDg2LjMwNTQgMjI3LjMgODguOTUyMyAyMjcuMDA4Qzg5LjYwNTEgMjI2LjkzNiA5MC4yNjg0IDIyNi44OTkgOTAuOTQwNCAyMjYuODk5SDMyOS41MTFDMzMwLjE4MyAyMjYuODk5IDMzMC44NDYgMjI2LjkzNiAzMzEuNDk4IDIyNy4wMDhDMzM0LjQxOSAyMjcuMzMgMzM3LjEyOCAyMjguMzUyIDMzOS40NTIgMjI5LjkwM1YyMDMuMTEyWk0zMzkuNDUyIDI0NC43MzlDMzM5LjQ1MiAyMzkuMzkzIDMzNS4yMDYgMjM1LjAzNiAzMjkuODkzIDIzNC44MzVDMzI5Ljc2NyAyMzQuODMgMzI5LjY0IDIzNC44MjggMzI5LjUxMSAyMzQuODI4SDkwLjk0MDRDODUuNDUwNSAyMzQuODI4IDgxIDIzOS4yNjUgODEgMjQ0LjczOVYyNzEuNTNMODEuMDcwNyAyNzEuNDgzQzgxLjI2NTMgMjcxLjM1NSA4MS40NjI1IDI3MS4yMyA4MS42NjI0IDI3MS4xMDlDODEuOTA4MyAyNzAuOTYgODIuMTU4MSAyNzAuODE3IDgyLjQxMTcgMjcwLjY3OUM4NC4zOTUzIDI2OS42MDUgODYuNjA1NCAyNjguODk0IDg4Ljk1MjMgMjY4LjYzNUM4OS4wMDUyIDI2OC42MjkgODkuMDU4IDI2OC42MjQgODkuMTExIDI2OC42MThDODkuNzEyNSAyNjguNTU3IDkwLjMyMjggMjY4LjUyNiA5MC45NDA0IDI2OC41MjZIMzI5LjUxMUMzMjkuNzM4IDI2OC41MjYgMzI5Ljk2NSAyNjguNTMgMzMwLjE5MiAyNjguNTM5QzMzMC42MzEgMjY4LjU1NSAzMzEuMDY3IDI2OC41ODcgMzMxLjQ5OCAyNjguNjM1QzMzNC40MTkgMjY4Ljk1NyAzMzcuMTI4IDI2OS45OCAzMzkuNDUyIDI3MS41M1YyNDQuNzM5Wk0zMzkuNDUyIDI4Ni4zNjZDMzM5LjQ1MiAyODEuMDIxIDMzNS4yMDYgMjc2LjY2MyAzMjkuODkzIDI3Ni40NjJMMzI5Ljg2NSAyNzYuNDYxQzMyOS43NDggMjc2LjQ1NyAzMjkuNjI5IDI3Ni40NTUgMzI5LjUxMSAyNzYuNDU1SDkwLjk0MDRDODUuNDUwNSAyNzYuNDU1IDgxIDI4MC44OTMgODEgMjg2LjM2NlYzMDYuMTg4QzgxIDMxMS42NjIgODUuNDUwNSAzMTYuMTAxIDkwLjk0MDQgMzE2LjEwMUgzMjkuNTExQzMzNS4wMDEgMzE2LjEwMSAzMzkuNDUyIDMxMS42NjIgMzM5LjQ1MiAzMDYuMTg4VjI4Ni4zNjZaIiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNMjY5Ljg2OCAxMzEuNzUyQzI2OS44NjggMTI2LjI3OCAyNzQuMzE4IDEyMS44NCAyNzkuODA4IDEyMS44NEgzMTEuNjE4QzMxNy4xMDggMTIxLjg0IDMyMS41NTggMTI2LjI3OCAzMjEuNTU4IDEzMS43NTJWMTYxLjQ4NUMzMjEuNTU4IDE2Ni45NTkgMzE3LjEwOCAxNzEuMzk2IDMxMS42MTggMTcxLjM5NkgyNzkuODA4QzI3NC4zMTggMTcxLjM5NiAyNjkuODY4IDE2Ni45NTkgMjY5Ljg2OCAxNjEuNDg1VjEzMS43NTJaIiBmaWxsPSJ3aGl0ZSIvPgo8L2c+CjxkZWZzPgo8Y2xpcFBhdGggaWQ9ImNsaXAwXzFfMTUiPgo8cmVjdCB3aWR0aD0iMjU5IiBoZWlnaHQ9IjIxMyIgZmlsbD0id2hpdGUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDgxIDEwNCkiLz4KPC9jbGlwUGF0aD4KPC9kZWZzPgo8L3N2Zz4K`,name:r=`Porto`,rdns:i=`xyz.ithaca.porto`}=typeof t==`object`?t:{};return Je.announceProvider({info:{icon:n,name:r,rdns:i,uuid:$i()},provider:e})}function So(e){return e.map(e=>{if(e.role===`admin`)try{return A.encode(vi.Key,{id:e.id??e.publicKey,publicKey:e.publicKey,type:e.type,...e.type===`webauthn-p256`?{credentialId:e.privateKey?.credential?.id,privateKey:{credential:{id:e.privateKey?.credential?.id},rpId:e.privateKey?.rpId}}:{}})}catch{return}}).filter(Boolean)}function Co(e,{address:t}){return e.map(e=>{if(e.chainId&&e.role===`session`&&!(e.expiry>0&&e.expiry<BigInt(Math.floor(Date.now()/1e3))))try{return A.encode(ba,xa(e,{address:t}))}catch{return}}).filter(Boolean)}function wo(e){return _(e.address)}function To(e){return e}function Eo(){let e=typeof indexedDB<`u`?Ye(`porto`,`store`):void 0;return To({async getItem(t){let n=await Ze(t,e);return n===null?null:n},async removeItem(t){await Xe(t,e)},async setItem(t,n){await Qe(t,Zi(n),e)},sizeLimit:1024*1024*50})}function Do(){let e=new Map;return To({getItem(t){return e.get(t)??null},removeItem(t){e.delete(t)},setItem(t,n){e.set(t,n)},sizeLimit:1/0})}const Oo=typeof window<`u`&&typeof document<`u`,ko={announceProvider:!0,chains:gn,mode:Oo?so({host:ia.prod}):oo(),relay:b(uo.prod.http),storage:Oo&&typeof indexedDB<`u`?Eo():Do(),storageKey:`porto.store`};function Ao(e={}){let t=e.chains??ko.chains,n=Object.fromEntries(t.map(t=>[t.id,e.transports?.[t.id]??b()])),r={announceProvider:e.announceProvider??ko.announceProvider,authUrl:e.authUrl,chains:t,feeToken:e.feeToken,merchantUrl:e.merchantUrl,mode:e.mode??ko.mode,relay:e.relay??ko.relay,storage:e.storage??ko.storage,storageKey:e.storageKey??ko.storageKey,transports:n},i=qe(We(Ke(Ge(e=>({accounts:[],chainIds:r.chains.map(e=>e.id),feeToken:r.feeToken,requestQueue:[]}),{merge(e,t){let n=e,i=r.chains.find(e=>e.id===n.chainIds[0])?.id??r.chains[0].id,a=[i,...r.chains.map(e=>e.id).filter(e=>e!==i)];return{...t,...n,chainIds:a}},name:r.storageKey,partialize:e=>({accounts:e.accounts.map(e=>Zi(e)),chainIds:e.chainIds}),storage:r.storage,version:5})))),a=r.mode,o={config:r,getMode(){return a},id:$i(),setMode(e){return c?.(),a=e,c=e.setup({internal:o}),c},store:i},s=bo(o),c=a===null?()=>{}:a.setup({internal:o});return{_internal:o,config:r,destroy(){c(),s._internal.destroy()},provider:s}}const jo=new Map;function Mo(e,t={}){let{provider:n}=e,{id:r}=e._internal,i=[`provider`,r].filter(Boolean).join(`:`);if(jo.has(i))return jo.get(i);let a=f({...t,pollingInterval:1e3,transport:m(n)});return jo.set(i,a),a}async function No(e={}){let{dialog:t}=e;return Mo(Ao({announceProvider:!1,chains:[oe,se],mode:so({host:t?new URL(`/dialog`,`https://`+t).toString():void 0,renderer:await _a()})}),{chain:oe})}async function Po(i,a){let o=await No(a);dn(`Create a Porto Account`);let s=mn(),c=a.adminKey?On():void 0,l;if(c)try{let r=n.join(t.tmpdir(),`porto`);e.mkdirSync(r,{mode:448,recursive:!0}),l=n.join(r,`admin-key-${Date.now()}-${Math.random().toString(36).slice(2)}.key`),e.writeFileSync(l,c.privateKey(),{mode:384})}catch{}let u=!!c;function d(e,t){if(!u)return process.exit(1);try{s.stop(`Interrupted.`)}catch{}if(t){let n=t instanceof Error?t.message:String(t);z.info(`${e??`Error`}: ${n}`)}c&&(l?z.info(`Admin key saved securely to temporary file: ${l}`):z.warn(`Admin key could not be saved to a temporary file. Please rerun to generate a new key.`)),u=!1,process.exit(1)}let f=()=>d(`SIGINT`),p=()=>d(`SIGTERM`),m=e=>d(`uncaughtException`,e),h=e=>d(`unhandledRejection`,e),g=()=>{u&&=(c&&(l?z.info(`Admin key saved securely to temporary file:\n${l}`):z.warn(`Admin key could not be saved to a temporary file. Please rerun to generate a new key.`)),!1)};c&&(process.on(`SIGINT`,f),process.on(`SIGTERM`,p),process.on(`uncaughtException`,m),process.on(`unhandledRejection`,h),process.on(`exit`,g)),c&&X.registerPublicKey(c.publicKey);let _=a.testnet?se.id:oe.id;s.start(`Creating account...`);let{accounts:v}=await Hi(o,{chainIds:[_],createAccount:!0,grantAdmins:c?[{publicKey:c.publicKey,type:c.type}]:void 0});if(s.stop(`Account created.`),s.start(`Onramping...`),await o.request({method:`wallet_addFunds`,params:[{address:v[0].address,token:a.testnet?void 0:`0x0000000000000000000000000000000000000000`}]}),s.stop(`Onramped.`),X.send(`success`,{content:`You have successfully created an account.`,title:`Account created`}),c){let{digest:e,...t}=await o.request({method:`wallet_prepareCalls`,params:[{calls:[],chainId:ee(_),key:c}]}),n=await V(c,{address:null,payload:e,wrap:!1}),r=await o.request({method:`wallet_sendPreparedCalls`,params:[{...t,signature:n}]});s.start(`Initializing account...`),await te.waitForCallsStatus(o,{id:r[0].id,throwOnFailure:!0}),s.stop(`Account initialized.`)}if(c){let t=await un({initialValue:!1,message:`Reveal private key? (This will be visible in terminal)`});if(z.info(`Address: `+v[0].address),t)z.info(`Private key: `+c?.privateKey());else{let t=n.join(import.meta.dirname,`${v[0].address}.key`);e.writeFileSync(t,c?.privateKey(),{mode:384}),e.chmodSync(t,384),z.info(`Private key saved securely to: ${t}`)}if(l)try{e.rmSync(l)}catch{}}z.info(`Manage your account at: https://id.porto.sh`),u=!1,c&&(process.off(`SIGINT`,f),process.off(`SIGTERM`,p),process.off(`uncaughtException`,m),process.off(`unhandledRejection`,h),process.off(`exit`,g)),await r(1e3),process.exit(0)}export{Po as createAccount};